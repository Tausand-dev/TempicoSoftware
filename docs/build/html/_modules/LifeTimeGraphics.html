

<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LifeTimeGraphics &mdash; Tempico Software 1.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=def9ab29"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Tempico Software
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../LifeTimeGraphics.html">LifeTimeGraphics module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../StartStopHist.html">StartStopHist module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutDialog.html">aboutDialog module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CountsEstimatedGraphics.html">CountsEstimatedGraphics module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../createsavefile.html">createsavefile module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../findDevices.html">findDevices module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../generalsettings.html">generalsettings module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../main.html">main module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Tempico Software</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Module code</a></li>
      <li class="breadcrumb-item active">LifeTimeGraphics</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for LifeTimeGraphics</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="kn">import</span> <span class="n">QTimer</span><span class="p">,</span> <span class="n">QTime</span><span class="p">,</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QMetaObject</span><span class="p">,</span> <span class="n">QThread</span><span class="p">,</span> <span class="n">Signal</span><span class="p">,</span> <span class="n">Slot</span>
<span class="kn">from</span> <span class="nn">PySide2.QtGui</span> <span class="kn">import</span> <span class="n">QPixmap</span><span class="p">,</span> <span class="n">QPainter</span><span class="p">,</span> <span class="n">QColor</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QComboBox</span><span class="p">,</span> <span class="n">QFrame</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QSpinBox</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QTableWidget</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="p">,</span> <span class="n">QDialog</span><span class="p">,</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QFormLayout</span><span class="p">,</span> <span class="n">QDoubleSpinBox</span>
<span class="kn">import</span> <span class="nn">pyqtgraph</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">array</span><span class="p">,</span> <span class="nb">sum</span><span class="p">,</span> <span class="n">arange</span><span class="p">,</span> <span class="n">histogram</span><span class="p">,</span> <span class="n">linspace</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">append</span> <span class="k">as</span> <span class="n">appnd</span>
<span class="kn">from</span> <span class="nn">createsavefile</span> <span class="kn">import</span> <span class="n">createsavefile</span> <span class="k">as</span> <span class="n">savefile</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">pyqtgraph.exporters</span> <span class="kn">import</span> <span class="n">ImageExporter</span>
<div class="viewcode-block" id="LifeTimeGraphic"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic">[docs]</a><span class="k">class</span> <span class="nc">LifeTimeGraphic</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class responsible for the logic and functionality of the LifeTime (Fluorescence Lifetime Measurement) window.</span>

<span class="sd">    This class manages the creation and updating of graphical plots related to LifeTime, controls user interactions with various </span>
<span class="sd">    buttons, and ensures that measurements are taken from the specified channels. The class handles:</span>
<span class="sd">    - Initialization of the graphical interface elements.</span>
<span class="sd">    - Starting and stopping of measurements.</span>
<span class="sd">    - Saving of data and plots.</span>
<span class="sd">    - Displaying parameters of the measurements, such as the number of measurements taken, and the percentage of completion.</span>

<span class="sd">    :param comboBoxStartChannel: The combo box for selecting the start channel (QComboBox).</span>
<span class="sd">    :param comboBoxStopChannel: The combo box for selecting the stop channel (QComboBox).</span>
<span class="sd">    :param graphicFrame: The frame that holds the graphical plot (QFrame).</span>
<span class="sd">    :param startButton: The button to start the measurements (QPushButton).</span>
<span class="sd">    :param stopButton: The button to stop the measurements (QPushButton).</span>
<span class="sd">    :param initialParametersButton: The button to configure initial parameters (QPushButton).</span>
<span class="sd">    :param clearButton: The button to clear the graphs and data (QPushButton).</span>
<span class="sd">    :param saveDataButton: The button to save the measurement data (QPushButton).</span>
<span class="sd">    :param savePlotButton: The button to save the graph plot (QPushButton).</span>
<span class="sd">    :param statusLabel: The label showing the current status (QLabel).</span>
<span class="sd">    :param pointLabel: The label displaying the current point in the measurement (QLabel).</span>
<span class="sd">    :param binWidthComboBox: The combo box for selecting the bin width (QComboBox).</span>
<span class="sd">    :param numberBins: The combo box for selecting the number of bins (QComboBox).</span>
<span class="sd">    :param functionComboBox: The combo box for selecting a function (QComboBox).</span>
<span class="sd">    :param numberMeasurementsSpinBox: The spin box for specifying the number of measurements (QSpinBox).</span>
<span class="sd">    :param totalMeasurements: The label showing the total number of measurements (QLabel).</span>
<span class="sd">    :param totalStart: The label showing the number of measurements taken from the start channel (QLabel).</span>
<span class="sd">    :param totalTime: The label showing the total time of measurements (QLabel).</span>
<span class="sd">    :param timeRange: The label showing the time range for the measurements (QLabel).</span>
<span class="sd">    :param device: The connected Tempico device used for measurements.</span>
<span class="sd">    :param applyButton: The button for applying selected parameters (QPushButton).</span>
<span class="sd">    :param parameterTable: The table displaying the parameters of the measurements (QTableWidget).</span>
<span class="sd">    :param MainWindow: The main window that holds the application UI elements.</span>
<span class="sd">    :param timerStatus: The timer used for periodic updates (QTimer).</span>
<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#TO DO: DELETE TEMPICO CLASS TYPE OF THE VARIABLE</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">comboBoxStartChannel</span><span class="p">:</span> <span class="n">QComboBox</span><span class="p">,</span> <span class="n">comboBoxStopChannel</span><span class="p">:</span> <span class="n">QComboBox</span><span class="p">,</span> <span class="n">graphicFrame</span><span class="p">:</span><span class="n">QFrame</span><span class="p">,</span> <span class="n">startButton</span><span class="p">:</span> <span class="n">QPushButton</span><span class="p">,</span><span class="n">stopButton</span><span class="p">:</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">initialParametersButton</span><span class="p">:</span> <span class="n">QPushButton</span><span class="p">,</span>
                 <span class="n">clearButton</span><span class="p">:</span> <span class="n">QPushButton</span><span class="p">,</span><span class="n">saveDataButton</span><span class="p">:</span><span class="n">QPushButton</span><span class="p">,</span><span class="n">savePlotButton</span><span class="p">:</span><span class="n">QPushButton</span><span class="p">,</span><span class="n">statusLabel</span><span class="p">:</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">pointLabel</span><span class="p">:</span> <span class="n">QLabel</span><span class="p">,</span><span class="n">binWidthComboBox</span><span class="p">:</span> <span class="n">QComboBox</span><span class="p">,</span><span class="n">numberBins</span><span class="p">:</span><span class="n">QComboBox</span><span class="p">,</span><span class="n">functionComboBox</span><span class="p">:</span><span class="n">QComboBox</span><span class="p">,</span>
                 <span class="n">numberMeasurementsSpinBox</span><span class="p">:</span> <span class="n">QSpinBox</span><span class="p">,</span> <span class="n">totalMeasurements</span><span class="p">:</span> <span class="n">QLabel</span><span class="p">,</span><span class="n">totalStart</span><span class="p">:</span> <span class="n">QLabel</span><span class="p">,</span><span class="n">totalTime</span><span class="p">:</span> <span class="n">QLabel</span><span class="p">,</span><span class="n">timeRange</span><span class="p">:</span> <span class="n">QLabel</span><span class="p">,</span><span class="n">device</span><span class="p">,</span><span class="n">applyButton</span><span class="p">:</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">parameterTable</span><span class="p">:</span> <span class="n">QTableWidget</span><span class="p">,</span><span class="n">MainWindow</span><span class="p">,</span> <span class="n">timerConnection</span><span class="p">:</span> <span class="n">QTimer</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savefile</span><span class="o">=</span><span class="n">savefile</span><span class="p">()</span>
        <span class="c1">#Initialize the main window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">=</span><span class="n">MainWindow</span>
        <span class="c1">#Initialize the Tempico Device class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">device</span>
        <span class="c1">#Initialize comboBox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">=</span><span class="n">comboBoxStartChannel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">=</span><span class="n">comboBoxStopChannel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binWidthComboBox</span><span class="o">=</span><span class="n">binWidthComboBox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">=</span><span class="n">functionComboBox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberBins</span><span class="o">=</span><span class="n">numberBins</span>
        <span class="c1">#Initialize Buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">=</span><span class="n">startButton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopButton</span><span class="o">=</span><span class="n">stopButton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearButton</span><span class="o">=</span><span class="n">clearButton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveDataButton</span><span class="o">=</span><span class="n">saveDataButton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savePlotButton</span><span class="o">=</span><span class="n">savePlotButton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">applyButton</span><span class="o">=</span><span class="n">applyButton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialParametersButton</span><span class="o">=</span><span class="n">initialParametersButton</span>
        <span class="c1">#Initialize the labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusLabel</span><span class="o">=</span><span class="n">statusLabel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pointLabel</span><span class="o">=</span><span class="n">pointLabel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">=</span><span class="n">totalMeasurements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalStart</span><span class="o">=</span><span class="n">totalStart</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalTime</span><span class="o">=</span><span class="n">totalTime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeRange</span><span class="o">=</span><span class="n">timeRange</span>
        <span class="c1">#Initialize the spinBox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurementsSpinBox</span><span class="o">=</span><span class="n">numberMeasurementsSpinBox</span>
        <span class="c1">#Fix the original value of Channels comboBox</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexChangeStartChannel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexChangeStopChannel</span><span class="p">)</span>
        <span class="c1">#Set the enable init Buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveDataButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savePlotButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">applyButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialParametersButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1">#Get initial index for comboBoxChannels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldStartChannelIndex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldStopChannelIndex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="c1">#Create the timer for label with total Time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">QTime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timerMeasurements</span> <span class="o">=</span> <span class="n">QTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timerMeasurements</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_timer</span><span class="p">)</span>
        <span class="c1">#-----------------------------------#</span>
        <span class="c1">#-----------------------------------#</span>
        <span class="c1">#----------Graphic Creation---------#</span>
        <span class="c1">#-----------------------------------#</span>
        <span class="c1">#-----------------------------------#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicLayout</span><span class="o">=</span><span class="n">QHBoxLayout</span><span class="p">(</span><span class="n">graphicFrame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">winLifeTime</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">GraphicsLayoutWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">winLifeTime</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="c1">#Add the plot to the window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">winLifeTime</span><span class="o">.</span><span class="n">addPlot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1">#Add Labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">addLegend</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">graphicLayout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">winLifeTime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span>  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Data fit&#39;</span><span class="p">)</span>
        <span class="c1">#-----------------------------------#</span>
        <span class="c1">#-----------------------------------#</span>
        <span class="c1">#--------End Graphic Creation-------#</span>
        <span class="c1">#-----------------------------------#</span>
        <span class="c1">#-----------------------------------#</span>
        
        <span class="c1">#----------Buttons Connection-------#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startMeasurement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stopMeasurement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clearGraphic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">applyButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">applyAction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savePlotButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">savePlotLifeTime</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changeFunction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveDataButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveLifeTimeData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialParametersButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialParametersDialog</span><span class="p">)</span>
        <span class="c1">#--------End Buttons Connection-----#</span>
        
        <span class="c1">#----------Define other parameters and sentinels-------#</span>
        
        <span class="c1">#Sentinel to know if there is a current thread running</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadCreated</span><span class="o">=</span><span class="kc">False</span>
        <span class="c1">#List of measured  values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1">#List of time Values X axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1">#List of Fit Parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span><span class="s2">&quot;nan&quot;</span><span class="p">]</span>
        <span class="c1">#Sentinel to know what is the current fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="c1">#Sentiinels to check the files saved</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavetxt</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavecsv</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavedat</span><span class="o">=</span><span class="mi">0</span>  
        <span class="c1">#Variables for save the graphic </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Counts&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xDataFitCopy</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yDataFitCopy</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1">#InitialValuesFor exponential Fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialI0</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1">#InitialValuesFor kol Fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Kol</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Kol</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialBeta</span><span class="o">=</span><span class="mi">1</span>
        <span class="c1">#InitialValuesFor shifted Exponential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Shif</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Shif</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialAlpha</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialB</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1">#InitialValuesFor double Exponential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Doub</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Doub</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialTau1Doub</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialAlphaDoub</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1">#Initialize Paramaters Table for fit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parametersTable</span><span class="o">=</span><span class="n">parameterTable</span>
        <span class="c1">#Sentinel to check if there is a initial Parameters change</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersExp</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersKol</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersDoub</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersShif</span><span class="o">=</span><span class="kc">False</span>
        <span class="c1">#Variables to define the mode of the old channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelA</span><span class="o">=</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelB</span><span class="o">=</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelC</span><span class="o">=</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelD</span><span class="o">=</span><span class="mi">1</span>
        <span class="c1">#Variable to define the old number of runs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldNumberRuns</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timerConnection</span><span class="o">=</span><span class="n">timerConnection</span>
        <span class="c1">#--------End Define other parameters and sentinels-----#</span>
        <span class="c1">#--------Init the the timer to check the connection----#</span>
        <span class="c1">#Set the value of R^2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="o">=</span><span class="s2">&quot;Undefined&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            
            
    <span class="c1">#Verify the connection of the function</span>
<div class="viewcode-block" id="LifeTimeGraphic.checkDeviceStatus"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.checkDeviceStatus">[docs]</a>    <span class="k">def</span> <span class="nf">checkDeviceStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies the device&#39;s operational status by attempting to read its identification.</span>

<span class="sd">        This function performs the following actions:</span>
<span class="sd">        - Attempts to read the identification from the device to ensure it is functioning correctly.</span>
<span class="sd">        - If the read operation fails, it stops any running worker thread and disconnects the device from the serial port.</span>
<span class="sd">        - Displays an error message indicating that the connection with the device has been lost.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">readIdnFromDevice</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threadCreated</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disconnectedDevice</span><span class="p">()</span>
            <span class="n">msg_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
            <span class="n">msg_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Connection with the device has been lost&quot;</span><span class="p">)</span>
            <span class="n">msg_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Connection Error&quot;</span><span class="p">)</span>
            <span class="n">msg_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
            <span class="n">msg_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">msg_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>
            
        
    <span class="c1"># Functions to verify that start and stop will not be the same channels</span>
<div class="viewcode-block" id="LifeTimeGraphic.indexChangeStartChannel"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.indexChangeStartChannel">[docs]</a>    <span class="k">def</span> <span class="nf">indexChangeStartChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies that the options of the start and stop combo boxes are not the same </span>
<span class="sd">        when the start combo box is changed. If they are the same, it reverts to </span>
<span class="sd">        the previously selected option.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldStartChannelIndex</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oldStartChannelIndex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="LifeTimeGraphic.indexChangeStopChannel"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.indexChangeStopChannel">[docs]</a>    <span class="k">def</span> <span class="nf">indexChangeStopChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies that the options of the start and stop combo boxes are not the same </span>
<span class="sd">        when the stop combo box is changed. If they are the same, it reverts to </span>
<span class="sd">        the previously selected option.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldStopChannelIndex</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oldStopChannelIndex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span></div>
            
    <span class="c1">#Function to catch the start button action</span>
<div class="viewcode-block" id="LifeTimeGraphic.startMeasurement"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.startMeasurement">[docs]</a>    <span class="k">def</span> <span class="nf">startMeasurement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates the measurement process by clearing previous data, resetting the UI, and starting a new measurement thread.</span>

<span class="sd">        This function performs several actions to prepare for and start a new measurement:</span>
<span class="sd">        - Stops the status timer and disables/enables relevant buttons.</span>
<span class="sd">        - Clears previous graph data and resets parameter labels.</span>
<span class="sd">        - Saves the current channel modes and resets save parameters.</span>
<span class="sd">        - Updates the status label and color to indicate a running measurement.</span>
<span class="sd">        - Clears previously measured data and time, resetting the plot.</span>
<span class="sd">        - Retrieves the selected channels and initializes a new measurement thread with the selected parameters.</span>
<span class="sd">        - Connects signals from the worker thread to corresponding slots in the main thread for UI updates.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Disable or enable the necessary</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">applyButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialParametersButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binWidthComboBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberBins</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">disconnectButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopTimerConnection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurementsSpinBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;Start&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="s1">&#39;Counts &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Counts &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="s1">&#39;Counts Channels &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Channel &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Channel &quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Counts &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            
            
        <span class="c1">#Change the parameters labels to undefined</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resetParametersLabels</span><span class="p">()</span>
        <span class="c1">#Save the channels mode before measurement</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveMode</span><span class="p">()</span>
        <span class="c1">#Reset save parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavetxt</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavecsv</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavedat</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1">#Change status Values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeStatusLabel</span><span class="p">(</span><span class="s2">&quot;Measurement running&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeStatusColor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateLabels</span><span class="p">(</span><span class="s2">&quot;0&quot;</span><span class="p">,</span><span class="s2">&quot;0&quot;</span><span class="p">)</span>
        <span class="c1">#Reboot the list of measured values and time Data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
        <span class="c1">#Get the selected channels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getTempicoChannel</span><span class="p">()</span>
        <span class="n">timeRangeps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeRangeValue</span><span class="p">()</span>
        <span class="c1">#Init the timer measurements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">QTime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xDataFitCopy</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yDataFitCopy</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">activeMeasurement</span><span class="p">()</span>
        <span class="c1">#Create the thread object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">=</span><span class="n">WorkerThreadLifeTime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentStartChannel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">currentStopChannel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">binWidthComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurementsSpinBox</span><span class="o">.</span><span class="n">value</span><span class="p">(),</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="p">,</span><span class="n">timeRangeps</span><span class="p">)</span>
        
        <span class="c1">#Create connections to main thread </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">finished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">finishedThreadMeasurement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">createdSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changeCreatedStatus</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">statusSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changeStatusLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">pointSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changeStatusColor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">updateValues</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateMeasurement</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">updateLabel</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateLabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">disconectedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lostConnection</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">updateMeasurementsLabel</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateLabels</span><span class="p">)</span>
        <span class="c1">#Start the thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="LifeTimeGraphic.getUnits"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.getUnits">[docs]</a>    <span class="k">def</span> <span class="nf">getUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Receives a numerical value in picoseconds (ps) and returns a list with two values:</span>
<span class="sd">        the appropriate units for the value and a number indicating by how much to divide </span>
<span class="sd">        the value for conversion.</span>

<span class="sd">        :param value: The numerical value in picoseconds to convert.</span>
<span class="sd">        :return: A list containing the appropriate unit as a string and a number indicating </span>
<span class="sd">                the divisor for conversion.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mf">1e3</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;ps&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mf">1e6</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;ns&quot;</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mf">1e9</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;µs&quot;</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mf">1e12</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">]</span></div>
        
        
    
    <span class="c1">#Function to catch the stop button action</span>
<div class="viewcode-block" id="LifeTimeGraphic.stopMeasurement"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.stopMeasurement">[docs]</a>    <span class="k">def</span> <span class="nf">stopMeasurement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the measurement thread if it is created and executes the </span>
<span class="sd">        function enableAfterFinishedThread() if the thread is not created.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Disable or enable the necessary</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threadCreated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enableAfterFinisihThread</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">noMeasurement</span><span class="p">()</span></div>
    
    <span class="c1">#Function to clear the graphic</span>
<div class="viewcode-block" id="LifeTimeGraphic.clearGraphic"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.clearGraphic">[docs]</a>    <span class="k">def</span> <span class="nf">clearGraphic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clears the measured data and time lists when a measurement is in progress </span>
<span class="sd">        and also clears the graphic by executing the worker&#39;s clear function.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">threadCreated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">worker</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="LifeTimeGraphic.enableAfterFinisihThread"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.enableAfterFinisihThread">[docs]</a>    <span class="k">def</span> <span class="nf">enableAfterFinisihThread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes when a measurement ends, either by pressing the stop button </span>
<span class="sd">        or when it has naturally finished. Re-enables the buttons, combo boxes, </span>
<span class="sd">        and fields necessary for a new measurement or for saving data. </span>
<span class="sd">        Resets the default parameters for the settings.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Se ejecuta&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startTimerConnection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberBins</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clearButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">savePlotButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binWidthComboBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurementsSpinBox</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">tabs</span><span class="o">.</span><span class="n">setTabEnabled</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeStatusLabel</span><span class="p">(</span><span class="s2">&quot;No measurement running&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changeStatusColor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadCreated</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stopTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setOldMode</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">disconnectButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">applyButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialParametersButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersExp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersKol</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Kol</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Kol</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialBeta</span><span class="o">=</span><span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersShif</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Shif</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Shif</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialAlpha</span><span class="o">=</span><span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialB</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersDoub</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Doub</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Doub</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau1Doub</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialAlphaDoub</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveDataButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">noMeasurement</span><span class="p">()</span></div>
        
    
    <span class="c1">#Function to change the status measurement</span>
<div class="viewcode-block" id="LifeTimeGraphic.changeStatusLabel"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.changeStatusLabel">[docs]</a>    <span class="k">def</span> <span class="nf">changeStatusLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">textValue</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the text of the status label.</span>

<span class="sd">        :param textValue: The text to set for the status label (str).</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">textValue</span><span class="p">)</span></div>
        
    <span class="c1">#Function to change the color of point measurement</span>
<div class="viewcode-block" id="LifeTimeGraphic.changeStatusColor"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.changeStatusColor">[docs]</a>    <span class="k">def</span> <span class="nf">changeStatusColor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changes the color of the point in the status bar. Each color is assigned a specific numeric value.</span>

<span class="sd">        :param color: The numeric value corresponding to the desired color (int).</span>
<span class="sd">                    - 0: Gray</span>
<span class="sd">                    - 1: Green</span>
<span class="sd">                    - 2: Yellow</span>
<span class="sd">                    - 3: Orange</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pixmap</span> <span class="o">=</span> <span class="n">QPixmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pointLabel</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
        <span class="n">pixmap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">transparent</span><span class="p">)</span>  
        <span class="n">painter</span> <span class="o">=</span> <span class="n">QPainter</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">setRenderHint</span><span class="p">(</span><span class="n">QPainter</span><span class="o">.</span><span class="n">Antialiasing</span><span class="p">)</span> 
        <span class="c1">#Define the colors</span>
        <span class="c1">#Number 0 is for gray</span>
        <span class="c1">#Number 1 is for green</span>
        <span class="c1">#Number 2 is for yellow</span>
        <span class="c1">#Number 3 is for orange</span>
        <span class="k">if</span> <span class="n">color</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>  
        <span class="k">elif</span> <span class="n">color</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  
        <span class="k">elif</span> <span class="n">color</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  
        <span class="k">elif</span> <span class="n">color</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">painter</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>  
        <span class="n">painter</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">)</span>
        <span class="n">point_size</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pointLabel</span><span class="o">.</span><span class="n">width</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pointLabel</span><span class="o">.</span><span class="n">height</span><span class="p">())</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pointLabel</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">-</span> <span class="n">point_size</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pointLabel</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">-</span> <span class="n">point_size</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">drawEllipse</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">point_size</span><span class="p">,</span> <span class="n">point_size</span><span class="p">)</span>
        <span class="n">painter</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pointLabel</span><span class="o">.</span><span class="n">setPixmap</span><span class="p">(</span><span class="n">pixmap</span><span class="p">)</span></div>
        
    <span class="c1">#Function to get the tempico Channel from the comboBoxValue</span>
<div class="viewcode-block" id="LifeTimeGraphic.getTempicoChannel"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.getTempicoChannel">[docs]</a>    <span class="k">def</span> <span class="nf">getTempicoChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assigns the Tempico device channels based on the selected values from the combo boxes.</span>
<span class="sd">        The selected start and stop channels are assigned to the variables `currentStartChannel` </span>
<span class="sd">        and `currentStopChannel`, respectively. It also enables the corresponding channels.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">startChannelValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="n">stopChannelValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="c1">#Init with all channels disabled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">disableChannel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">disableChannel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">disableChannel</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">disableChannel</span><span class="p">()</span>
        
        <span class="c1">#Get the start channel before begin the measurement</span>
        <span class="k">if</span> <span class="n">startChannelValue</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStartChannel</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">elif</span> <span class="n">startChannelValue</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStartChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span>
        <span class="k">elif</span> <span class="n">startChannelValue</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStartChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span>
        <span class="k">elif</span> <span class="n">startChannelValue</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStartChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span>
        <span class="k">elif</span> <span class="n">startChannelValue</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStartChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span>
        
        <span class="c1">#Get the stop channel before begin the measurement</span>
        <span class="k">if</span> <span class="n">stopChannelValue</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStopChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span>
        <span class="k">elif</span> <span class="n">stopChannelValue</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStopChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span>
        <span class="k">elif</span> <span class="n">stopChannelValue</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStopChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span>
        <span class="k">elif</span> <span class="n">stopChannelValue</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">enableChannel</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentStopChannel</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span></div>
    
    
    <span class="c1">#Get the mode of the channel to save in a variable before start measurement</span>
<div class="viewcode-block" id="LifeTimeGraphic.saveMode"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.saveMode">[docs]</a>    <span class="k">def</span> <span class="nf">saveMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the current modes of the channels before starting a measurement.</span>
<span class="sd">        The modes are stored in the variables `oldChannelA`, `oldChannelB`, </span>
<span class="sd">        `oldChannelC`, and `oldChannelD`, allowing for restoration to the original settings after the measurement.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oldNumberRuns</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">getNumberOfRuns</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelA</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">getMode</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelB</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">getMode</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelC</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">getMode</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oldChannelD</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">getMode</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>
    
    <span class="c1">#Set the mode before measurement in every channel</span>
<div class="viewcode-block" id="LifeTimeGraphic.setOldMode"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.setOldMode">[docs]</a>    <span class="k">def</span> <span class="nf">setOldMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Restores the modes of the channels after a measurement is completed.</span>
<span class="sd">        The channels are set to their previous modes stored in `oldChannelA`, </span>
<span class="sd">        `oldChannelB`, `oldChannelC`, and `oldChannelD`.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>     
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">setNumberOfRuns</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldNumberRuns</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldChannelA</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldChannelB</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldChannelC</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oldChannelD</span><span class="p">)</span> 
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span></div>
        
        
    
    
    
        
    <span class="c1">#Get the value of the time range label</span>
<div class="viewcode-block" id="LifeTimeGraphic.timeRangeValue"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.timeRangeValue">[docs]</a>    <span class="k">def</span> <span class="nf">timeRangeValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the value from the timeRange label to picoseconds (ps).</span>

<span class="sd">        :return: float</span>
<span class="sd">            The value converted to picoseconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">unitsList</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeRange</span><span class="o">.</span><span class="n">text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">unitsList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ps&#39;</span><span class="p">:</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">unitsList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
        <span class="k">elif</span> <span class="n">unitsList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;µs&#39;</span><span class="p">:</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
        <span class="k">elif</span> <span class="n">unitsList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ms&#39;</span><span class="p">:</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span>
        <span class="n">valueRange</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">unitsList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">picoSecondsValue</span><span class="o">=</span><span class="n">valueRange</span><span class="o">*</span><span class="n">multiplier</span>
        <span class="k">return</span> <span class="n">picoSecondsValue</span></div>
            
    <span class="c1">#Function to execute when the thread is finished</span>
<div class="viewcode-block" id="LifeTimeGraphic.finishedThreadMeasurement"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.finishedThreadMeasurement">[docs]</a>    <span class="k">def</span> <span class="nf">finishedThreadMeasurement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Executes when the measurement thread finishes.</span>

<span class="sd">        This function enables the UI components related to new measurements </span>
<span class="sd">        and resets the settings to default.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">enableAfterFinisihThread</span><span class="p">()</span></div>
        
    <span class="c1">#Function to connect the signal with created thread sentinel</span>
<div class="viewcode-block" id="LifeTimeGraphic.changeCreatedStatus"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.changeCreatedStatus">[docs]</a>    <span class="k">def</span> <span class="nf">changeCreatedStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Notifies that the measurement thread has been created.</span>

<span class="sd">        This function sets the status of thread creation to True.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threadCreated</span><span class="o">=</span><span class="kc">True</span></div>
    
    <span class="c1">#Function to update the measured values</span>
<div class="viewcode-block" id="LifeTimeGraphic.updateMeasurement"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.updateMeasurement">[docs]</a>    <span class="k">def</span> <span class="nf">updateMeasurement</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">listOfNewValues</span><span class="p">,</span><span class="n">domainMeasurement</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the measured data and time with new values and refreshes the graph.</span>

<span class="sd">        This function receives a new list of values representing counts and their corresponding</span>
<span class="sd">        update times, assigning them to the variables measuredData and measuredTime, and </span>
<span class="sd">        updates the graph accordingly.</span>

<span class="sd">        :param listOfNewValues: The new list of measurement values (list).</span>
<span class="sd">        :param domainMeasurement: The list of times corresponding to the measurement values (list).</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="o">=</span><span class="n">listOfNewValues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="o">=</span><span class="n">domainMeasurement</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">curve</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span></div>
        
    <span class="c1">#Function to get the Label with the correct units</span>
<div class="viewcode-block" id="LifeTimeGraphic.updateLabel"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.updateLabel">[docs]</a>    <span class="k">def</span> <span class="nf">updateLabel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">units</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the label of the x-axis in the graph with the correct units for the data.</span>

<span class="sd">        This function takes the units as a string and updates the x-axis label accordingly.</span>

<span class="sd">        :param units: The units to be displayed on the x-axis label (str).</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">=</span><span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unitsLabel</span><span class="o">=</span><span class="s1">&#39;Time (&#39;</span><span class="o">+</span><span class="n">units</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="s1">&#39;Time (&#39;</span><span class="o">+</span><span class="n">units</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (&#39;</span><span class="o">+</span><span class="n">units</span><span class="o">+</span><span class="s1">&#39;)&#39;</span></div>
    
    
<div class="viewcode-block" id="LifeTimeGraphic.updateLabels"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.updateLabels">[docs]</a>    <span class="k">def</span> <span class="nf">updateLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">totalMeasurements</span><span class="p">,</span><span class="n">totalStarts</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the labels for total measurements and total starts with the given values.</span>

<span class="sd">        This function sets the text of the totalMeasurements and totalStart labels </span>
<span class="sd">        according to the parameters provided.</span>

<span class="sd">        :param totalMeasurements: The text to set for the total measurements label (str).</span>
<span class="sd">        :param totalStarts: The text to set for the total starts label (str).</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">totalMeasurements</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalStart</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">totalStarts</span><span class="p">)</span></div>
    
    <span class="c1">#Functions created for connect or disconnect the device</span>
<div class="viewcode-block" id="LifeTimeGraphic.connectedDevice"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.connectedDevice">[docs]</a>    <span class="k">def</span> <span class="nf">connectedDevice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">device</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the UI options when the Tempico device is connected.</span>

<span class="sd">        This function enables and disables the appropriate buttons and starts the timer to monitor the device status.</span>
<span class="sd">        - Enables the disconnect button and disables the connect button.</span>
<span class="sd">        - Starts a status timer with a 500 ms interval.</span>
<span class="sd">        - Assigns the connected device to the class attribute and enables the start button.</span>

<span class="sd">        :param device: The connected Tempico device.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">disconnectButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">connectButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="LifeTimeGraphic.stopTimerConnection"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.stopTimerConnection">[docs]</a>    <span class="k">def</span> <span class="nf">stopTimerConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timerConnection</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="LifeTimeGraphic.startTimerConnection"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.startTimerConnection">[docs]</a>    <span class="k">def</span> <span class="nf">startTimerConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timerConnection</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span></div>
        
        
<div class="viewcode-block" id="LifeTimeGraphic.disconnectedDevice"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.disconnectedDevice">[docs]</a>    <span class="k">def</span> <span class="nf">disconnectedDevice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Configures the UI options when the Tempico device is disconnected.</span>

<span class="sd">        This function disables and enables the appropriate buttons and stops the timer that monitors the device status.</span>
<span class="sd">        - Disables the disconnect button and enables the connect button.</span>
<span class="sd">        - Stops the status timer.</span>
<span class="sd">        - Disables the start button.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">disconnectButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="o">.</span><span class="n">connectButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startButton</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>
    
    <span class="c1">#Functions to update the totalTime Label</span>
<div class="viewcode-block" id="LifeTimeGraphic.update_timer"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.update_timer">[docs]</a>    <span class="k">def</span> <span class="nf">update_timer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the timer for the ongoing measurement by adding one second.</span>

<span class="sd">        This function increments the time variable by one second and updates the </span>
<span class="sd">        totalTime label to reflect the new time.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">addSecs</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalTime</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">toString</span><span class="p">(</span><span class="s1">&#39;hh:mm:ss&#39;</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="LifeTimeGraphic.startTimer"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.startTimer">[docs]</a>    <span class="k">def</span> <span class="nf">startTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the timer that triggers the update_timer function every second.</span>

<span class="sd">        This function initiates the timer for the ongoing measurement, allowing</span>
<span class="sd">        the update_timer function to be executed at one-second intervals.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timerMeasurements</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="LifeTimeGraphic.stopTimer"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.stopTimer">[docs]</a>    <span class="k">def</span> <span class="nf">stopTimer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the timer that triggers the update_timer function.</span>

<span class="sd">        This function halts the timer responsible for updating the measurement time</span>
<span class="sd">        and sets the totalTime label to indicate that no measurement is currently running.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timerMeasurements</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalTime</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;No measurement running&quot;</span><span class="p">)</span></div>
    
    <span class="c1">#Connection with change of comboBox</span>
<div class="viewcode-block" id="LifeTimeGraphic.changeFunction"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.changeFunction">[docs]</a>    <span class="k">def</span> <span class="nf">changeFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the parameter values in the UI based on the selected function in the functionComboBox.</span>

<span class="sd">        This function checks the current fitting function (e.g., &quot;ExpDecay&quot;, &quot;Kohlrausch&quot;, &quot;ShiftedExponential&quot;, or </span>
<span class="sd">        &quot;DoubleExponential&quot;) and updates the parameter labels accordingly. If the parameters have already been calculated,</span>
<span class="sd">        it will display the values along with their uncertainties and units. If the parameters are not available, it sets </span>
<span class="sd">        the values to &quot;Undefined&quot;.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - Parameters like &quot;I0&quot;, &quot;tau0&quot;, &quot;Beta&quot;, &quot;alpha&quot;, &quot;b&quot;, &quot;R^2&quot;, and their respective uncertainties are assigned using </span>
<span class="sd">        `insertParameters()` based on the fitting model.</span>
<span class="sd">        - Units are assigned through the `self.units` attribute for certain parameters (e.g., tau0).</span>
<span class="sd">        </span>
<span class="sd">        Behavior by function:</span>
<span class="sd">        - ExpDecay: Updates `I0`, `tau0`, and `R^2`.</span>
<span class="sd">        - Kohlrausch: Updates `I0`, `tau0`, `Beta`, and `R^2`.</span>
<span class="sd">        - ShiftedExponential: Updates `I0`, `tau0`, `alpha`, `b`, and `R^2`.</span>
<span class="sd">        - DoubleExponential: Updates `I0`, `tau0`, `tau1`, `alpha`, and `R^2`.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;ExpDecay&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;Undefined&quot;</span><span class="p">:</span>

                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;Kohlrausch&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;Undefined&quot;</span><span class="p">:</span>
                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the Beta parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;β&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the Beta parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;β&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;ShiftedExponential&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;Undefined&quot;</span><span class="p">:</span>
                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the alpha parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the b parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the alpha parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the b parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;DoubleExponential&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="s2">&quot;Undefined&quot;</span><span class="p">:</span>
                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau1 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;τ1&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">])),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the alpha parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">])),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#Change the I0 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the tau1 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;τ1&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################   </span>
                <span class="c1">#Change the alpha parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#Change the I0 parameter values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="c1">####################</span>
            <span class="c1">#Change the tau parameter values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="c1">####################</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1">#Change the Beta parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;β&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="c1">#Change the alpha parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the b parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
                <span class="c1">#Change the tau1 parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;τ1&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change the alpha parameter values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">####################</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span></div>
                <span class="c1">####################</span>
        
<div class="viewcode-block" id="LifeTimeGraphic.insertParameters"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.insertParameters">[docs]</a>    <span class="k">def</span> <span class="nf">insertParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">Parameter</span><span class="p">,</span><span class="n">Value</span><span class="p">,</span><span class="n">Cov</span><span class="p">,</span><span class="n">Units</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Inserts the parameter values into the fitting table at the specified row.</span>

<span class="sd">        This function updates the table used for displaying the fitted parameters by inserting the parameter name, its </span>
<span class="sd">        value, the covariance (uncertainty), and the units in the specified row of the table.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The parameter name is assigned to the first column of the specified row (`index`).</span>
<span class="sd">        - The value of the parameter is assigned to the second column.</span>
<span class="sd">        - The covariance of the parameter is assigned to the third column.</span>
<span class="sd">        - The units of the parameter are assigned to the fourth column.</span>

<span class="sd">        :param index: The row index where the values will be inserted (int).</span>
<span class="sd">        :param Parameter: The name of the parameter to be displayed (str).</span>
<span class="sd">        :param Value: The value of the parameter to be displayed (str).</span>
<span class="sd">        :param Cov: The covariance (uncertainty) of the parameter (str).</span>
<span class="sd">        :param Units: The units of the parameter (str).</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Change parameter values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parametersTable</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">Parameter</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parametersTable</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">Value</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parametersTable</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">Cov</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parametersTable</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">Units</span><span class="p">))</span></div>
        <span class="c1">####################</span>
             
    <span class="c1">#Connection with the ApplyButton</span>
<div class="viewcode-block" id="LifeTimeGraphic.applyAction"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.applyAction">[docs]</a>    <span class="k">def</span> <span class="nf">applyAction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Captures the action of the &#39;apply&#39; button, calculates the selected fit, and stores the resulting parameters.</span>

<span class="sd">        This function determines which fitting function is selected from `functionComboBox` and attempts to calculate</span>
<span class="sd">        the fit using the measured time and data. If the parameters can be determined, they are stored in `FitParameters`.</span>
<span class="sd">        If not, a dialog informs the user that the parameters could not be determined.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The parameters `i0`, `tau0`, and other fit-specific variables are calculated using the corresponding fit function.</span>
<span class="sd">        - If the fit is successful, the rounded parameters are stored in `FitParameters`.</span>
<span class="sd">        - If the fit fails or returns &quot;Undefined&quot;, a message box is shown to inform the user of the error.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Exponential&quot;</span><span class="p">:</span>
                    <span class="n">i0</span><span class="p">,</span><span class="n">tau0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitExpDecay</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i0</span><span class="o">==</span><span class="s2">&quot;Undefined&quot;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">i0</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;ExpDecay&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Kohlrausch&quot;</span><span class="p">:</span>
                    <span class="n">i0</span><span class="p">,</span><span class="n">tau0</span><span class="p">,</span><span class="n">beta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitKohlrauschFit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i0</span><span class="o">==</span><span class="s2">&quot;Undefined&quot;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">i0</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;fitKohlrausch&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                    
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Shifted exponential&quot;</span><span class="p">:</span>
                    <span class="n">i0</span><span class="p">,</span><span class="n">tau0</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitShiiftedExponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i0</span><span class="o">==</span><span class="s2">&quot;Undefined&quot;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">i0</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>   
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;ShiftedExponential&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Double exponential&quot;</span><span class="p">:</span>
                    <span class="n">i0</span><span class="p">,</span><span class="n">tau0</span><span class="p">,</span><span class="n">tau1</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fitDoubleExponential</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i0</span><span class="o">==</span><span class="s2">&quot;Undefined&quot;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">i0</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>   
                        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;DoubleExponential&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">i0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">tau1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                    
            <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
                <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>
    
                    
    <span class="c1">#Reset the labels when a measurement begins</span>
<div class="viewcode-block" id="LifeTimeGraphic.resetParametersLabels"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.resetParametersLabels">[docs]</a>    <span class="k">def</span> <span class="nf">resetParametersLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets all the fit parameters to &#39;Undefined&#39; and clears the current fit type.</span>

<span class="sd">        This function sets the list `FitParameters` to contain &quot;Undefined&quot; values for all parameters and clears `currentFit`.</span>
<span class="sd">        Additionally, it resets the `R2` value to &quot;Undefined&quot;. Depending on the selected fit type in `functionComboBox`,</span>
<span class="sd">        the respective parameter labels in the table are updated to reflect &quot;Undefined&quot; values.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - `FitParameters` is reset to a list of &quot;Undefined&quot;.</span>
<span class="sd">        - `currentFit` is cleared to an empty string.</span>
<span class="sd">        - `R2` is reset to &quot;Undefined&quot;.</span>
<span class="sd">        - The `insertParameters` method is used to update the table with &quot;Undefined&quot; values for each parameter</span>
<span class="sd">        based on the selected function in `functionComboBox`.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="o">=</span><span class="s2">&quot;Undefined&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Double exponential&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;τ1&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Shifted exponential&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Kohlrausch&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;β&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">functionComboBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Exponential&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span></div>
            
            
    <span class="c1">#fit exponential curver</span>
<div class="viewcode-block" id="LifeTimeGraphic.fitExpDecay"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.fitExpDecay">[docs]</a>    <span class="k">def</span> <span class="nf">fitExpDecay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xData</span><span class="p">,</span><span class="n">yData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the exponential decay fit for the given data.</span>

<span class="sd">        This function attempts to fit an exponential decay model to the provided `xData` and `yData`. If successful,</span>
<span class="sd">        the optimal parameters (I0, tau0) are used to update the respective labels in the parameters table along with</span>
<span class="sd">        their uncertainties (covariance), and the fitted curve is plotted. If the fit cannot be performed, it alerts</span>
<span class="sd">        the user via a message box.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - `self.FitCov`: Contains the covariance values for I0 and tau0, or &quot;nan&quot; if not calculable.</span>
<span class="sd">        - `self.xDataFitCopy`: Stores a copy of the `xData` for the fitted curve.</span>
<span class="sd">        - `self.yDataFitCopy`: Stores the computed y-values for the fitted curve.</span>
<span class="sd">        - `self.R2`: Stores the calculated R² value for the fit.</span>
<span class="sd">        - `self.curveFit`: Updates the plot with the fitted curve data.</span>

<span class="sd">        :param xData: The x-axis data points (array-like).</span>
<span class="sd">        :param yData: The y-axis data points (array-like).</span>
<span class="sd">        :return: Tuple (I0_opt, tau0_opt) containing the fitted values of I0 and tau0, or (&quot;Undefined&quot;, &quot;Undefined&quot;) if fitting fails.</span>
<span class="sd">        :rtype: tuple(float, float) or tuple(str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initial guess for the parameters</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0</span><span class="p">]</span>
            <span class="c1"># Curve fitting</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_decay</span><span class="p">,</span> <span class="n">xData</span><span class="p">,</span> <span class="n">yData</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">initial_guess</span><span class="p">)</span>
            <span class="c1"># Extracting the optimal values of I0 and tau0</span>
            <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span> <span class="o">=</span> <span class="n">popt</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xDataFitCopy</span><span class="o">=</span><span class="n">xData</span>
            <span class="n">yFit</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xData</span><span class="p">:</span>
                <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_decay</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">)</span>
                <span class="n">yFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yDataFitCopy</span><span class="o">=</span><span class="n">yFit</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">I_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">tau_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">I_0Cov</span><span class="o">&gt;</span><span class="n">I0_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">I_0Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">I_0CovString</span>
                <span class="k">if</span> <span class="n">tau_0Cov</span><span class="o">&gt;</span><span class="n">tau_0Cov</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">tau_0Cov</span><span class="p">)</span>    
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">tau_0CovString</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>         
            <span class="c1">#Graphic of the fit curve</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">xData</span><span class="p">,</span><span class="n">yFit</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
                <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r2Parameter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateR2</span><span class="p">(</span><span class="n">yData</span><span class="p">,</span><span class="n">yFit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">r2Parameter</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">maxRoundTau0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)</span>
                <span class="n">maxRoundI0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)</span>
                <span class="c1">#Change I0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">,</span><span class="n">maxRoundTau0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change tau0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0_opt</span><span class="p">,</span><span class="n">maxRoundI0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>


            <span class="k">return</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
            <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">return</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span></div>
        

    <span class="c1">#fit kohlrausch curver</span>
<div class="viewcode-block" id="LifeTimeGraphic.fitKohlrauschFit"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.fitKohlrauschFit">[docs]</a>    <span class="k">def</span> <span class="nf">fitKohlrauschFit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xData</span><span class="p">,</span><span class="n">yData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the Kohlrausch fit for the given data.</span>

<span class="sd">        This function attempts to fit a Kohlrausch (stretched exponential) model to the provided `xData` and `yData`.</span>
<span class="sd">        If successful, the optimal parameters (I0, tau0, Beta) are used to update the respective labels in the parameters</span>
<span class="sd">        table along with their uncertainties (covariance), and the fitted curve is plotted. If the fit cannot be performed,</span>
<span class="sd">        it alerts the user via a message box.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - `self.FitCov`: Contains the covariance values for I0, tau0, and Beta, or &quot;nan&quot; if not calculable.</span>
<span class="sd">        - `self.xDataFitCopy`: Stores a copy of the `xData` for the fitted curve.</span>
<span class="sd">        - `self.yDataFitCopy`: Stores the computed y-values for the fitted curve.</span>
<span class="sd">        - `self.R2`: Stores the calculated R² value for the fit.</span>
<span class="sd">        - `self.curveFit`: Updates the plot with the fitted curve data.</span>

<span class="sd">        :param xData: The x-axis data points (array-like).</span>
<span class="sd">        :param yData: The y-axis data points (array-like).</span>
<span class="sd">        :return: Tuple (I0_opt, tau0_opt, beta_opt) containing the fitted values of I0, tau0, and Beta, or (&quot;Undefined&quot;, &quot;Undefined&quot;, &quot;Undefined&quot;) if fitting fails.</span>
<span class="sd">        :rtype: tuple(float, float, float) or tuple(str, str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Initial guess for the parameters</span>
            <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Kol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Kol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialBeta</span><span class="p">]</span>
            <span class="c1"># Curve fitting</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kohl_decay</span><span class="p">,</span> <span class="n">xData</span><span class="p">,</span> <span class="n">yData</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">initial_guess</span><span class="p">)</span>
            <span class="c1"># Extracting the optimal values of I0 and tau0</span>
            <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">beta_opt</span> <span class="o">=</span> <span class="n">popt</span>
            <span class="n">yFit</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xData</span><span class="p">:</span>
                <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kohl_decay</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span><span class="n">beta_opt</span><span class="p">)</span>
                <span class="n">yFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xDataFitCopy</span><span class="o">=</span><span class="n">xData</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yDataFitCopy</span><span class="o">=</span><span class="n">yFit</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">I_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">tau_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">betaCov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="c1">#Try to get the first parameter</span>
                <span class="k">if</span> <span class="n">I_0Cov</span><span class="o">&gt;</span><span class="n">I0_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>    
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">I_0Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">I_0CovString</span>
                <span class="c1">#Try to get the second parameter</span>
                <span class="k">if</span> <span class="n">tau_0Cov</span><span class="o">&gt;</span><span class="n">tau0_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>    
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">tau_0Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">tau_0CovString</span>
                    
                <span class="c1">#Try to get the third parameter</span>
                
                <span class="k">if</span> <span class="n">betaCov</span><span class="o">&gt;</span><span class="n">beta_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>    
                    <span class="n">betaCovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">betaCovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">betaCov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">betaCovString</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
            <span class="c1">#Graphic of the fit curve</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">xData</span><span class="p">,</span><span class="n">yFit</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
                <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r2Parameter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateR2</span><span class="p">(</span><span class="n">yData</span><span class="p">,</span><span class="n">yFit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">r2Parameter</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">maxRoundTau0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)</span>
                <span class="n">maxRoundI0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)</span>
                <span class="n">maxRoundBeta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">betaCovString</span><span class="p">)</span>
                <span class="c1">#Change I0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0_opt</span><span class="p">,</span><span class="n">maxRoundI0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change tau0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">,</span><span class="n">maxRoundTau0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">#Change Beta parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;β&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">beta_opt</span><span class="p">,</span><span class="n">maxRoundBeta</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">betaCovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">beta_opt</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
            <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>  
            <span class="k">return</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span></div>
    <span class="c1">#Initial Parameters Dialog</span>
<div class="viewcode-block" id="LifeTimeGraphic.initialParametersDialog"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.initialParametersDialog">[docs]</a>    <span class="k">def</span> <span class="nf">initialParametersDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays a dialog for selecting initial parameters for fitting functions.</span>

<span class="sd">        This dialog allows the user to select a type of fitting function and input the corresponding parameters.</span>
<span class="sd">        The parameters that can be set include:</span>
<span class="sd">        - I0 (initial value)</span>
<span class="sd">        - tau0 (decay constant)</span>
<span class="sd">        - beta (for Kohlrausch fit)</span>
<span class="sd">        - alpha (for Shifted Exponential fit)</span>
<span class="sd">        - b (for Shifted Exponential fit)</span>
<span class="sd">        </span>
<span class="sd">        The dialog contains a ComboBox to select the function type, and the input fields dynamically update based on</span>
<span class="sd">        the selected function. It includes &quot;Apply&quot; and &quot;Reset&quot; buttons to apply changes or revert to default values.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The input values from the dialog are assigned to respective attributes, but are not directly returned.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialDialog</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialDialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Select Function Parameters&quot;</span><span class="p">)</span>
        <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialDialog</span><span class="p">)</span>
        <span class="c1"># ComboBox for selecting the function type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">addItems</span><span class="p">([</span><span class="s2">&quot;Exponential fit&quot;</span><span class="p">,</span> <span class="s2">&quot;Kohlrausch fit&quot;</span><span class="p">,</span> <span class="s2">&quot;Shifted Exponential fit&quot;</span><span class="p">,</span><span class="s2">&quot;Double Exponential fit&quot;</span><span class="p">])</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="p">)</span>
        <span class="c1"># Form layout for input fields</span>
        <span class="n">form_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">form_layout</span><span class="p">)</span>
        <span class="c1"># Input fields for Exponential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
        
        <span class="c1"># Additional fields for Kolrausch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Beta_field</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Beta_field</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Beta_field</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
        
        <span class="c1"># Additional fields for Shifted Exponential</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">))</span>
        <span class="c1"># Function to update the form based on the selected function</span>
        <span class="k">def</span> <span class="nf">update_form</span><span class="p">():</span>
            <span class="c1"># Clear the form</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">form_layout</span><span class="o">.</span><span class="n">count</span><span class="p">())):</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">itemAt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">widget</span><span class="p">()</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Exponential fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;I&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;τ&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Kohlrausch fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Kol</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Kol</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Beta_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialBeta</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;I&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;τ&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;β:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Beta_field</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Shifted Exponential fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Shif</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Shif</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialAlpha</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialB</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;I&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;τ&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;α:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;b:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Double Exponential fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Doub</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Doub</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau1Doub</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialAlphaDoub</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;I&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;τ&lt;sub&gt;0&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;τ&lt;sub&gt;1&lt;\sub&gt;:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="p">)</span>
                <span class="n">form_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="s2">&quot;α:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="p">)</span>
        <span class="c1"># Connect the ComboBox change signal to the update function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">update_form</span><span class="p">)</span>
        <span class="c1"># Initialize the form</span>
        <span class="n">update_form</span><span class="p">()</span>
        <span class="c1"># Apply and Reset buttons</span>
        <span class="n">button_layout</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">apply_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Apply&quot;</span><span class="p">)</span>
        <span class="n">reset_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Default Values&quot;</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">apply_button</span><span class="p">)</span>
        <span class="n">button_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">reset_button</span><span class="p">)</span>
        <span class="n">apply_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">applyInitialDialog</span><span class="p">)</span>
        <span class="n">reset_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">resetInitialDialog</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">button_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialDialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>
    
    <span class="c1">#Function to connect the apply button</span>
<div class="viewcode-block" id="LifeTimeGraphic.applyInitialDialog"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.applyInitialDialog">[docs]</a>    <span class="k">def</span> <span class="nf">applyInitialDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the initial parameters based on user input from the parameter dialog.</span>

<span class="sd">        This function is called when the user clicks the &quot;Apply&quot; button in the parameter dialog. </span>
<span class="sd">        It retrieves the values from the input fields corresponding to the selected fitting function </span>
<span class="sd">        and assigns them to the appropriate instance variables. </span>

<span class="sd">        The following parameters are updated based on the selected fit type:</span>
<span class="sd">        - For Exponential fit:</span>
<span class="sd">        - I0 (initial value)</span>
<span class="sd">        - tau0 (decay constant)</span>
<span class="sd">        - For Kohlrausch fit:</span>
<span class="sd">        - I0 (initial value)</span>
<span class="sd">        - tau0 (decay constant)</span>
<span class="sd">        - beta (exponent)</span>
<span class="sd">        - For Shifted Exponential fit:</span>
<span class="sd">        - I0 (initial value)</span>
<span class="sd">        - tau0 (decay constant)</span>
<span class="sd">        - alpha (shift parameter)</span>
<span class="sd">        - b (baseline value)</span>
<span class="sd">        - For Double Exponential fit:</span>
<span class="sd">        - I0 (initial value)</span>
<span class="sd">        - tau0 (first decay constant)</span>
<span class="sd">        - tau1 (second decay constant)</span>
<span class="sd">        - alpha (mixing coefficient)</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The updated values are assigned to their respective initial parameter variables.</span>
<span class="sd">        - A boolean flag indicating that initial parameters have changed is set to True for the relevant fit type.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Exponential fit&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialI0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersExp</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Kohlrausch fit&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Kol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Kol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialBeta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Beta_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersKol</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Shifted Exponential fit&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Shif</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Shif</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialAlpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialB</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersShif</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Double Exponential fit&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Doub</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Doub</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialTau1Doub</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initialAlphaDoub</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersDoub</span><span class="o">=</span><span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialDialog</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>
    <span class="c1">#Function to connect the reset button</span>
<div class="viewcode-block" id="LifeTimeGraphic.resetInitialDialog"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.resetInitialDialog">[docs]</a>    <span class="k">def</span> <span class="nf">resetInitialDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets the initial parameters in the dialog based on the measured data.</span>

<span class="sd">        This function is called when the user clicks the &quot;Default Values&quot; button in the parameter dialog. </span>
<span class="sd">        It resets the initial parameters to sensible defaults derived from the measured data. </span>
<span class="sd">        The following resets occur based on the selected fitting function:</span>
<span class="sd">        </span>
<span class="sd">        - For Exponential fit:</span>
<span class="sd">            - I0 is set to the maximum value of measured data.</span>
<span class="sd">            - tau0 is set to the mean of measured time.</span>
<span class="sd">        - For Kohlrausch fit:</span>
<span class="sd">            - I0 is set to the maximum value of measured data.</span>
<span class="sd">            - tau0 is set to the mean of measured time.</span>
<span class="sd">            - beta is set to 1.0 (default value).</span>
<span class="sd">        - For Shifted Exponential fit:</span>
<span class="sd">            - I0 is set to the maximum value of measured data.</span>
<span class="sd">            - tau0 is set to the mean of measured time.</span>
<span class="sd">            - alpha is set to 0 (default value).</span>
<span class="sd">            - b is set to 0 (default value).</span>
<span class="sd">        - For Double Exponential fit:</span>
<span class="sd">            - I0 is set to the maximum value of measured data.</span>
<span class="sd">            - tau0 is set to the mean of measured time.</span>
<span class="sd">            - alpha is set to 0 (default value).</span>
<span class="sd">            - tau1 is set to the mean of measured time.</span>

<span class="sd">        The corresponding input fields in the dialog are updated with these new values. </span>
<span class="sd">        Flags indicating that the initial parameters have not changed are also reset to False for the relevant fit type.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Exponential fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersExp</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Kohlrausch fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Kol</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Kol</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialBeta</span><span class="o">=</span><span class="mf">1.0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Beta_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialBeta</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Kol</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Kol</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersKol</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Shifted Exponential fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Shif</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Shif</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialAlpha</span><span class="o">=</span><span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialB</span><span class="o">=</span><span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Shif</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Shif</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialAlpha</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialB</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersShif</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">combo_box</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;Double Exponential fit&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialI0Doub</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Doub</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialAlphaDoub</span><span class="o">=</span><span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">initialTau1Doub</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">I_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Doub</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Tau_0_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Doub</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Alpha_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialTau1Doub</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B_field</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">initialAlphaDoub</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changeInitialParametersDoub</span><span class="o">=</span><span class="kc">False</span></div>
        

    
    <span class="c1">#fit Shifted Exponential</span>
<div class="viewcode-block" id="LifeTimeGraphic.fitShiiftedExponential"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.fitShiiftedExponential">[docs]</a>    <span class="k">def</span> <span class="nf">fitShiiftedExponential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xData</span><span class="p">,</span> <span class="n">yData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fits a shifted exponential decay model to the provided data.</span>

<span class="sd">        This function fits a shifted exponential decay model to the given `xData` and `yData` using the initial guesses for </span>
<span class="sd">        the parameters (I0, tau0, alpha, b). If the fit is successful, it updates the corresponding values for each parameter </span>
<span class="sd">        and plots the fitted curve. If the fit fails, a warning message is displayed to the user.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - `self.FitCov`: Stores the covariance values for I0, tau0, alpha, and b, or &quot;nan&quot; if not calculable.</span>
<span class="sd">        - `self.xDataFitCopy`: Stores a copy of the `xData` for the fitted curve.</span>
<span class="sd">        - `self.yDataFitCopy`: Stores the computed y-values for the fitted curve.</span>
<span class="sd">        - `self.R2`: Stores the calculated R² value for the fit.</span>
<span class="sd">        - `self.curveFit`: Updates the plot with the fitted curve data.</span>

<span class="sd">        :param xData: The x-axis data points (array-like).</span>
<span class="sd">        :param yData: The y-axis data points (array-like).</span>
<span class="sd">        :return: Tuple (I0_opt, tau0_opt, alpha_opt, b_opt) containing the fitted values of I0, tau0, alpha, and b, or </span>
<span class="sd">                (&quot;Undefined&quot;, &quot;Undefined&quot;, &quot;Undefined&quot;, &quot;Undefined&quot;) if fitting fails.</span>
<span class="sd">        :rtype: tuple(float, float, float, float) or tuple(str, str, str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Initial guess for the parameters: I0, tau0, alpha, b</span>
            <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Shif</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Shif</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialAlpha</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialB</span><span class="p">]</span>
            <span class="c1"># Curve fitting</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shifted_decay_function</span><span class="p">,</span> <span class="n">xData</span><span class="p">,</span> <span class="n">yData</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">initial_guess</span><span class="p">)</span>
            <span class="c1"># Extracting the optimal values of I0, tau0, alpha, and b</span>
            <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">alpha_opt</span><span class="p">,</span> <span class="n">b_opt</span> <span class="o">=</span> <span class="n">popt</span>
            <span class="c1"># Calculate the fitted curve</span>
            <span class="n">yFit</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xData</span><span class="p">:</span>
                <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shifted_decay_function</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">alpha_opt</span><span class="p">,</span> <span class="n">b_opt</span><span class="p">)</span>
                <span class="n">yFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xDataFitCopy</span><span class="o">=</span><span class="n">xData</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yDataFitCopy</span><span class="o">=</span><span class="n">yFit</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">I_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">tau_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">alphaCov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">bCov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                
                <span class="c1">#Get I0 parameter</span>
                <span class="k">if</span> <span class="n">I_0Cov</span><span class="o">&gt;</span><span class="n">I0_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">I_0Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">I_0CovString</span>
        
                <span class="c1">#Get tau parameter</span>
                <span class="k">if</span> <span class="n">tau_0Cov</span><span class="o">&gt;</span><span class="n">tau0_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">tau_0Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">tau_0CovString</span>
               
               <span class="c1">#Get alpha parameter</span>
                <span class="k">if</span> <span class="n">alphaCov</span><span class="o">&gt;</span><span class="n">alpha_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">alphaCovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">alphaCovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">alphaCov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">alphaCovString</span>
                
                
                <span class="c1">#Get b parameter</span>
                <span class="k">if</span> <span class="n">bCov</span><span class="o">&gt;</span><span class="n">b_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">bCovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bCovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">bCov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">bCovString</span>
                
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
            <span class="c1"># Graphic of the fit curve</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">xData</span><span class="p">,</span> <span class="n">yFit</span><span class="p">)</span>
            <span class="c1"># Set the fitted parameters in the UI</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
                <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r2Parameter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateR2</span><span class="p">(</span><span class="n">yData</span><span class="p">,</span><span class="n">yFit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">r2Parameter</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">maxRoundTau0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)</span>
                <span class="n">maxRoundI0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)</span>
                <span class="n">maxRoundAlpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">alphaCovString</span><span class="p">)</span>
                <span class="n">maxRoundB</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">bCovString</span><span class="p">)</span>
                <span class="c1">#Change I0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">,</span> <span class="n">maxRoundTau0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change tau0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0_opt</span><span class="p">,</span> <span class="n">maxRoundI0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">#Change alpha parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">alpha_opt</span><span class="p">,</span> <span class="n">maxRoundAlpha</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">alphaCovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change b parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">b_opt</span><span class="p">,</span> <span class="n">maxRoundB</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">bCovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">alpha_opt</span><span class="p">,</span> <span class="n">b_opt</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
            <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">return</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span></div>
    
    
    <span class="c1">#fit Double exponential</span>
<div class="viewcode-block" id="LifeTimeGraphic.fitDoubleExponential"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.fitDoubleExponential">[docs]</a>    <span class="k">def</span> <span class="nf">fitDoubleExponential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xData</span><span class="p">,</span> <span class="n">yData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fits a double exponential decay model to the provided data.</span>

<span class="sd">        This function fits a double exponential decay model to the given `xData` and `yData` using the initial guesses for </span>
<span class="sd">        the parameters (I0, tau0, tau1, alpha). If the fit is successful, it updates the corresponding values for each </span>
<span class="sd">        parameter and plots the fitted curve. If the fit fails, a warning message is displayed to the user.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - `self.FitCov`: Stores the covariance values for I0, tau0, tau1, and alpha, or &quot;nan&quot; if not calculable.</span>
<span class="sd">        - `self.xDataFitCopy`: Stores a copy of the `xData` for the fitted curve.</span>
<span class="sd">        - `self.yDataFitCopy`: Stores the computed y-values for the fitted curve.</span>
<span class="sd">        - `self.R2`: Stores the calculated R² value for the fit.</span>
<span class="sd">        - `self.curveFit`: Updates the plot with the fitted curve data.</span>

<span class="sd">        :param xData: The x-axis data points (array-like).</span>
<span class="sd">        :param yData: The y-axis data points (array-like).</span>
<span class="sd">        :return: Tuple (I0_opt, tau0_opt, tau1_opt, alpha_opt) containing the fitted values of I0, tau0, tau1, and alpha, </span>
<span class="sd">                or (&quot;Undefined&quot;, &quot;Undefined&quot;, &quot;Undefined&quot;, &quot;Undefined&quot;) if fitting fails.</span>
<span class="sd">        :rtype: tuple(float, float, float, float) or tuple(str, str, str, str)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Initial guess for the parameters: I0, tau0, alpha, b</span>
            <span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">initialI0Doub</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialTau0Doub</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialTau1Doub</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialAlphaDoub</span><span class="p">]</span>
            <span class="c1"># Curve fitting</span>
            <span class="n">popt</span><span class="p">,</span> <span class="n">pcov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">double_Exponential</span><span class="p">,</span> <span class="n">xData</span><span class="p">,</span> <span class="n">yData</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">initial_guess</span><span class="p">)</span>
            <span class="c1"># Extracting the optimal values of I0, tau0, alpha, and b</span>
            <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">tau1_opt</span><span class="p">,</span> <span class="n">alpha_opt</span> <span class="o">=</span> <span class="n">popt</span>
            <span class="c1"># Calculate the fitted curve</span>
            <span class="n">yFit</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xData</span><span class="p">:</span>
                <span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">double_Exponential</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">tau1_opt</span><span class="p">,</span> <span class="n">alpha_opt</span><span class="p">)</span>
                <span class="n">yFit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xDataFitCopy</span><span class="o">=</span><span class="n">xData</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">yDataFitCopy</span><span class="o">=</span><span class="n">yFit</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">I_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">tau_0Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">tau_1Cov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">alphaCov</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pcov</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
                
                <span class="c1">#Get I0 parameter</span>
                <span class="k">if</span> <span class="n">I_0Cov</span><span class="o">&gt;</span><span class="n">I0_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">I_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">I_0Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">I_0CovString</span>
        
                <span class="c1">#Get tau parameter</span>
                <span class="k">if</span> <span class="n">tau_0Cov</span><span class="o">&gt;</span><span class="n">tau0_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tau_0CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">tau_0Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">tau_0CovString</span>
               
               <span class="c1">#Get tau1 parameter</span>
                <span class="k">if</span> <span class="n">tau_1Cov</span><span class="o">&gt;</span><span class="n">tau1_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">tau_1CovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">tau_1CovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">tau_1Cov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">tau_1CovString</span>
                
                
                <span class="c1">#Get alpha parameter</span>
                <span class="k">if</span> <span class="n">alphaCov</span><span class="o">&gt;</span><span class="n">alpha_opt</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                    <span class="n">alphaCovString</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">alphaCovString</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">roundStringPCov</span><span class="p">(</span><span class="n">alphaCov</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">alphaCovString</span>           
            <span class="k">except</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">FitCov</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span>
            <span class="c1"># Graphic of the fit curve</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="n">xData</span><span class="p">,</span> <span class="n">yFit</span><span class="p">)</span>
            <span class="c1"># Set the fitted parameters in the UI</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
                <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">r2Parameter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calculateR2</span><span class="p">(</span><span class="n">yData</span><span class="p">,</span><span class="n">yFit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">r2Parameter</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">maxRoundTau0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)</span>
                <span class="n">maxRoundI0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)</span>
                <span class="n">maxRoundTau1</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">tau_1CovString</span><span class="p">)</span>
                <span class="n">maxRoundalpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maxRound</span><span class="p">(</span><span class="n">alphaCovString</span><span class="p">)</span>
                <span class="c1">#Change I0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;I0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">I0_opt</span><span class="p">,</span> <span class="n">maxRoundTau0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">I_0CovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change tau0 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&quot;τ0&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">tau0_opt</span><span class="p">,</span> <span class="n">maxRoundI0</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tau_0CovString</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">#Change alpha parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;τ1&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">tau1_opt</span><span class="p">,</span> <span class="n">maxRoundTau1</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">tau_1CovString</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>
                <span class="c1">#Change b parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;α&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">alpha_opt</span><span class="p">,</span> <span class="n">maxRoundalpha</span><span class="p">)),</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">alphaCovString</span><span class="p">)),</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Change R^2 parameter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">insertParameters</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;R^2&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R2</span><span class="p">),</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">I0_opt</span><span class="p">,</span> <span class="n">tau0_opt</span><span class="p">,</span> <span class="n">tau1_opt</span><span class="p">,</span> <span class="n">alpha_opt</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">curveFit</span><span class="o">.</span><span class="n">setData</span><span class="p">([],[])</span>
            <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Warning</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The parameters for the graph could not be determined.&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error generating the fit&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">return</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span><span class="p">,</span><span class="s2">&quot;Undefined&quot;</span></div>
        
    
    
        
        
        
    <span class="c1">#Exponential Decay Function</span>
<div class="viewcode-block" id="LifeTimeGraphic.exp_decay"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.exp_decay">[docs]</a>    <span class="k">def</span> <span class="nf">exp_decay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the value of an exponential decay function.</span>

<span class="sd">        This function calculates the value of the exponential decay function using the given parameters for time `t`, </span>
<span class="sd">        initial value `I0`, and decay constant `tau0`.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The computed value is returned directly and not assigned to any variable within the function.</span>

<span class="sd">        :param t: The time at which to evaluate the function (float).</span>
<span class="sd">        :param I0: The initial value of the exponential function (float).</span>
<span class="sd">        :param tau0: The decay constant (float).</span>
<span class="sd">        :return: The value of the exponential decay function at time `t`.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">I0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="n">tau0</span><span class="p">)</span></div>

    <span class="c1">#Kohlrausch Decay Function</span>
<div class="viewcode-block" id="LifeTimeGraphic.kohl_decay"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.kohl_decay">[docs]</a>    <span class="k">def</span> <span class="nf">kohl_decay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">,</span><span class="n">beta</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the value of a Kohlrausch (stretched exponential) decay function.</span>

<span class="sd">        This function calculates the value of the stretched exponential (Kohlrausch) decay function using the given parameters: </span>
<span class="sd">        time `t`, initial value `I0`, decay constant `tau0`, and stretching parameter `beta`.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The computed value is returned directly and not assigned to any variable within the function.</span>

<span class="sd">        :param t: The time at which to evaluate the function (float).</span>
<span class="sd">        :param I0: The initial value of the exponential function (float).</span>
<span class="sd">        :param tau0: The decay constant (float).</span>
<span class="sd">        :param beta: The stretching exponent, controlling the deviation from a simple exponential decay (float).</span>
<span class="sd">        :return: The value of the stretched exponential decay function at time `t`.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">I0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">((</span><span class="o">-</span><span class="n">t</span> <span class="o">/</span> <span class="n">tau0</span><span class="p">)</span><span class="o">**</span><span class="n">beta</span><span class="p">)</span></div>
    
    <span class="c1">#Shifted Exponential Function</span>
<div class="viewcode-block" id="LifeTimeGraphic.shifted_decay_function"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.shifted_decay_function">[docs]</a>    <span class="k">def</span> <span class="nf">shifted_decay_function</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the value of a shifted exponential decay function.</span>

<span class="sd">        This function calculates the value of a shifted exponential decay function using the given parameters: </span>
<span class="sd">        time `t`, initial value `I0`, decay constant `tau0`, shift parameter `alpha`, and constant offset `b`.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The computed value is returned directly and not assigned to any variable within the function.</span>

<span class="sd">        :param t: The time at which to evaluate the function (float).</span>
<span class="sd">        :param I0: The initial value of the exponential function (float).</span>
<span class="sd">        :param tau0: The decay constant (float).</span>
<span class="sd">        :param alpha: The shift parameter, determining the horizontal shift of the decay function (float).</span>
<span class="sd">        :param b: The constant offset added to the decay function (float).</span>
<span class="sd">        :return: The value of the shifted exponential decay function at time `t`.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Define the decay function with the new equation</span>
        <span class="k">return</span> <span class="n">I0</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">tau0</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span></div>
    <span class="c1">#Double Exponential Function</span>
<div class="viewcode-block" id="LifeTimeGraphic.double_Exponential"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.double_Exponential">[docs]</a>    <span class="k">def</span> <span class="nf">double_Exponential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span> <span class="n">I0</span><span class="p">,</span> <span class="n">tau0</span><span class="p">,</span> <span class="n">tau1</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the value of a double exponential decay function.</span>

<span class="sd">        This function calculates the value of a double exponential decay function using the given parameters: </span>
<span class="sd">        time `t`, initial value `I0`, decay constants `tau0` and `tau1`, and mixing parameter `alpha`.</span>

<span class="sd">        Variables assignment:</span>
<span class="sd">        - The computed value is returned directly and not assigned to any variable within the function.</span>

<span class="sd">        :param t: The time at which to evaluate the function (float).</span>
<span class="sd">        :param I0: The initial value of the exponential function (float).</span>
<span class="sd">        :param tau0: The first decay constant (float).</span>
<span class="sd">        :param tau1: The second decay constant (float).</span>
<span class="sd">        :param alpha: The mixing parameter that determines the contribution of the first decay (float).</span>
<span class="sd">        :return: The value of the double exponential decay function at time `t`.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">I0</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau0</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau1</span><span class="p">))</span></div>

    <span class="c1">#Function to get the maximum number of decimal numbers from sd (Standard Deviation)</span>
    
<div class="viewcode-block" id="LifeTimeGraphic.maxRound"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.maxRound">[docs]</a>    <span class="k">def</span> <span class="nf">maxRound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the number of decimal places needed for at least three significant figures.</span>

<span class="sd">        :param string: The number as a string (str).</span>
<span class="sd">        :return: Number of decimal places (int).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span> <span class="ow">and</span> <span class="s1">&#39;e&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">3</span>
            
            <span class="n">parts</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;[eE]&#39;</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>
            <span class="n">base</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">base</span><span class="p">:</span>
                <span class="n">base_decimals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">base_decimals</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">exponent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">total_decimals</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">base_decimals</span> <span class="o">-</span> <span class="n">exponent</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">total_decimals</span> <span class="o">=</span> <span class="n">base_decimals</span>
            
            <span class="k">return</span> <span class="n">total_decimals</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">3</span></div>
    

    <span class="c1">#Function to get the string of the pcov numbers</span>
    
<div class="viewcode-block" id="LifeTimeGraphic.roundStringPCov"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.roundStringPCov">[docs]</a>    <span class="k">def</span> <span class="nf">roundStringPCov</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts a number to a string representation in scientific notation with two decimal places.</span>

<span class="sd">        :param number: The input number (float).</span>
<span class="sd">        :return: String representation in scientific notation (str).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;0.00&quot;</span>
        <span class="n">exponent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">))))</span>
        <span class="n">rounded_number</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">number</span> <span class="o">/</span> <span class="p">(</span><span class="mi">10</span> <span class="o">**</span> <span class="n">exponent</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">exponent</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rounded_number</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">e</span><span class="si">{</span><span class="n">exponent</span><span class="si">:</span><span class="s2">+d</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rounded_number</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span></div>
    
    <span class="c1">#Function to calculate the parameter R^2</span>

<div class="viewcode-block" id="LifeTimeGraphic.calculateR2"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.calculateR2">[docs]</a>    <span class="k">def</span> <span class="nf">calculateR2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">fitData</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the R² value based on the observed and fitted data.</span>

<span class="sd">        :param data: The observed data points (array-like).</span>
<span class="sd">        :param fitData: The fitted data points (array-like).</span>
<span class="sd">        :return: The R² value indicating the goodness of fit (float).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Get the array</span>
        <span class="n">arrayData</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">arrayFit</span><span class="o">=</span><span class="n">array</span><span class="p">(</span><span class="n">fitData</span><span class="p">)</span>
        <span class="c1">#Mean data</span>
        <span class="n">meanData</span><span class="o">=</span><span class="n">mean</span><span class="p">(</span><span class="n">arrayData</span><span class="p">)</span>
        <span class="c1">#Get the residue</span>
        <span class="n">ssRes</span><span class="o">=</span><span class="nb">sum</span><span class="p">((</span><span class="n">arrayData</span><span class="o">-</span><span class="n">arrayFit</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#Get the total sum squared</span>
        <span class="n">ssTot</span><span class="o">=</span><span class="nb">sum</span><span class="p">((</span><span class="n">arrayData</span><span class="o">-</span><span class="n">meanData</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="c1">#Get R^2</span>
        <span class="n">R2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="n">ssRes</span><span class="o">/</span><span class="n">ssTot</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">R2</span></div>

        
    
    <span class="c1">#Save buttons</span>
    <span class="c1">#Save Plot Button</span>
<div class="viewcode-block" id="LifeTimeGraphic.savePlotLifeTime"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.savePlotLifeTime">[docs]</a>    <span class="k">def</span> <span class="nf">savePlotLifeTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the graph image in the specified format (PNG, TIFF, or JPG) based on the user&#39;s selection.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">graph_names</span><span class="o">=</span><span class="p">[]</span>
            <span class="c1">#Open select the format</span>
            <span class="n">dialog</span> <span class="o">=</span><span class="n">QDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>    
            <span class="n">dialog</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;ImageFormat&quot;</span><span class="p">)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">285</span><span class="p">,</span><span class="mi">105</span><span class="p">)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Save Plots&quot;</span><span class="p">)</span>
            <span class="n">verticalLayout_2</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
            <span class="n">verticalLayout_2</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;verticalLayout_2&quot;</span><span class="p">)</span>
            <span class="n">VerticalImage</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
            <span class="n">VerticalImage</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;VerticalImage&quot;</span><span class="p">)</span>
            <span class="n">SelectLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
            <span class="n">SelectLabel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;SelectLabel&quot;</span><span class="p">)</span>
            <span class="n">SelectLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Select the image format:&quot;</span><span class="p">)</span>
            <span class="n">VerticalImage</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">SelectLabel</span><span class="p">)</span>
            <span class="n">FormatBox</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
            <span class="n">FormatBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
            <span class="n">FormatBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;tiff&quot;</span><span class="p">)</span>
            <span class="n">FormatBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;jpg&quot;</span><span class="p">)</span>
            <span class="n">FormatBox</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;FormatBox&quot;</span><span class="p">)</span>
            <span class="n">VerticalImage</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">FormatBox</span><span class="p">)</span>
            <span class="n">verticalLayout_2</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">VerticalImage</span><span class="p">)</span>
            
            <span class="n">accepButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
            <span class="n">accepButton</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;accepButton&quot;</span><span class="p">)</span>
            <span class="n">accepButton</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Accept&quot;</span><span class="p">)</span>
            <span class="n">verticalLayout_2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">accepButton</span><span class="p">)</span>
            
            <span class="n">QMetaObject</span><span class="o">.</span><span class="n">connectSlotsByName</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
            
            <span class="c1"># Connect the button &quot;Accept&quot; to the accept dialog method</span>
            <span class="n">accepButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dialog</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span><span class="o">==</span><span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
                <span class="n">selected_format</span><span class="o">=</span><span class="n">FormatBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                <span class="n">copyWin</span><span class="o">=</span><span class="n">pg</span><span class="o">.</span><span class="n">GraphicsLayoutWidget</span><span class="p">()</span>
                <span class="n">copyWin</span><span class="o">.</span><span class="n">setBackground</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
                <span class="n">copyPlot</span><span class="o">=</span><span class="n">copyWin</span><span class="o">.</span><span class="n">addPlot</span><span class="p">()</span>
                <span class="n">copyPlot</span><span class="o">.</span><span class="n">showGrid</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">copyPlot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ylabel</span><span class="p">)</span>
                <span class="n">copyPlot</span><span class="o">.</span><span class="n">setLabel</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xlabel</span><span class="p">)</span>
                <span class="n">copyPlot</span><span class="o">.</span><span class="n">addLegend</span><span class="p">()</span>
                <span class="n">copyCurve</span><span class="o">=</span><span class="n">copyPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
                <span class="n">copyFit</span><span class="o">=</span><span class="n">copyPlot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pen</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Data fit&#39;</span><span class="p">)</span>
                <span class="n">copyCurve</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span><span class="p">)</span>
                <span class="n">copyFit</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xDataFitCopy</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">yDataFitCopy</span><span class="p">)</span>
                <span class="c1"># Add a footer for the graphic</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;ExpDecay&quot;</span><span class="p">:</span>
                    <span class="n">textFooter</span><span class="o">=</span><span class="s2">&quot;Fit: I&lt;sub&gt;0&lt;/sub&gt;*e^(-t/τ&lt;sub&gt;0&lt;/sub&gt;) , Parameters: I&lt;sub&gt;0&lt;/sub&gt;=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; τ&lt;sub&gt;0&lt;/sub&gt;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;fitKohlrausch&quot;</span><span class="p">:</span>
                    <span class="n">textFooter</span><span class="o">=</span><span class="s2">&quot;Fit: I&lt;sub&gt;0&lt;/sub&gt;*e^((-t/τ&lt;sub&gt;0&lt;/sub&gt;)^(β)) , Parameters: I&lt;sub&gt;0&lt;/sub&gt;=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; τ&lt;sub&gt;0&lt;/sub&gt;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">+</span><span class="s2">&quot; 	β:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;ShiftedExponential&quot;</span><span class="p">:</span>
                    <span class="n">textFooter</span><span class="o">=</span><span class="s2">&quot;Fit: I&lt;sub&gt;0&lt;/sub&gt;*e^((-t+α)/τ&lt;sub&gt;0&lt;/sub&gt;))+b, Parameters: I&lt;sub&gt;0&lt;/sub&gt;=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; τ&lt;sub&gt;0&lt;/sub&gt;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">+</span><span class="s2">&quot; α:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; b:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;DoubleExponential&quot;</span><span class="p">:</span>
                    <span class="n">textFooter</span><span class="o">=</span><span class="s2">&quot;Fit: I&lt;sub&gt;0&lt;/sub&gt;*(α*e^(-t/τ&lt;sub&gt;0&lt;/sub&gt;)+(1-α)*e^(-t/τ&lt;sub&gt;1&lt;/sub&gt;)), Parameters: I&lt;sub&gt;0&lt;/sub&gt;=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; τ&lt;sub&gt;0&lt;/sub&gt;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">+</span><span class="s2">&quot; τ&lt;sub&gt;1&lt;/sub&gt;:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="o">+</span><span class="s2">&quot; α:&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">textFooter</span><span class="o">=</span><span class="s2">&quot;No fit has been applied&quot;</span>
                    
                <span class="n">footer</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">LabelItem</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">textFooter</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
                <span class="n">copyWin</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="n">footer</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">copyWin</span><span class="o">.</span><span class="n">ci</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">setRowStretchFactor</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
                <span class="n">copyPlot</span><span class="o">.</span><span class="n">getViewBox</span><span class="p">()</span><span class="o">.</span><span class="n">setState</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotLifeTime</span><span class="o">.</span><span class="n">getViewBox</span><span class="p">()</span><span class="o">.</span><span class="n">getState</span><span class="p">())</span>
                <span class="n">exporter</span><span class="o">=</span><span class="n">ImageExporter</span><span class="p">(</span><span class="n">copyWin</span><span class="o">.</span><span class="n">scene</span><span class="p">())</span>
                <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span>
                <span class="n">exporter</span><span class="o">.</span><span class="n">parameters</span><span class="p">()[</span><span class="s1">&#39;height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">700</span>
                <span class="n">folder_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">savefile</span><span class="o">.</span><span class="n">read_default_data</span><span class="p">()[</span><span class="s1">&#39;Folder path&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">current_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="n">current_date_str</span><span class="o">=</span><span class="n">current_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">graph_name</span><span class="o">=</span><span class="s1">&#39;LifeTimeMeasurement&#39;</span><span class="o">+</span><span class="n">current_date_str</span>
                <span class="n">exporter</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">folder_path</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">graph_name</span><span class="o">+</span><span class="s1">&#39;.&#39;</span><span class="o">+</span><span class="n">selected_format</span><span class="p">)</span>
                <span class="n">initial_text</span><span class="o">=</span><span class="s2">&quot;The plots have been saved successfully in &quot;</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span> <span class="s2">&quot;with the following names:&quot;</span>
                <span class="n">text_route</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">graph_name</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="o">+</span><span class="n">selected_format</span>
                <span class="n">graph_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">graph_name</span><span class="p">)</span>
                <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">initial_text</span><span class="o">+</span><span class="n">text_route</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Successful save&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="c1"># show successful save</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>            
        <span class="k">except</span><span class="p">:</span>
            <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The plots could not be saved.&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error saving&quot;</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
            <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>
            
    <span class="c1">#Save Data Button</span>
<div class="viewcode-block" id="LifeTimeGraphic.saveLifeTimeData"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.saveLifeTimeData">[docs]</a>    <span class="k">def</span> <span class="nf">saveLifeTimeData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves the data in the selected format (TXT, CSV, or DAT) based on the user&#39;s choice.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Open select the format</span>
        <span class="n">dialog</span> <span class="o">=</span> <span class="n">QDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;TextFormat&quot;</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">282</span><span class="p">,</span> <span class="mi">105</span><span class="p">)</span>
        <span class="n">dialog</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Save&quot;</span><span class="p">)</span>
        <span class="n">verticalLayout_2</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
        <span class="n">verticalLayout_2</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;verticalLayout_2&quot;</span><span class="p">)</span>
        <span class="n">VerticalImage</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">VerticalImage</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;VerticalImage&quot;</span><span class="p">)</span>
        <span class="n">SelectLabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
        <span class="n">SelectLabel</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;SelectLabel&quot;</span><span class="p">)</span>
        <span class="n">SelectLabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Select the text format:&quot;</span><span class="p">)</span>
        <span class="n">VerticalImage</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">SelectLabel</span><span class="p">)</span>
        <span class="n">FormatBox</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
        <span class="n">FormatBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;txt&quot;</span><span class="p">)</span>
        <span class="n">FormatBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span>
        <span class="n">FormatBox</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s2">&quot;dat&quot;</span><span class="p">)</span>
        <span class="n">FormatBox</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;FormatBox&quot;</span><span class="p">)</span>
        <span class="n">VerticalImage</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">FormatBox</span><span class="p">)</span>
        <span class="n">verticalLayout_2</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">VerticalImage</span><span class="p">)</span>
        <span class="n">accepButton</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
        <span class="n">accepButton</span><span class="o">.</span><span class="n">setObjectName</span><span class="p">(</span><span class="s2">&quot;accepButton&quot;</span><span class="p">)</span>
        <span class="n">accepButton</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Accept&quot;</span><span class="p">)</span>
        <span class="n">verticalLayout_2</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">accepButton</span><span class="p">)</span>
        <span class="n">QMetaObject</span><span class="o">.</span><span class="n">connectSlotsByName</span><span class="p">(</span><span class="n">dialog</span><span class="p">)</span>
        <span class="c1"># Connect the accept button with real accept</span>
        <span class="n">accepButton</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dialog</span><span class="o">.</span><span class="n">accept</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span> <span class="o">==</span> <span class="n">QDialog</span><span class="o">.</span><span class="n">Accepted</span><span class="p">:</span>
            <span class="n">selected_format</span> <span class="o">=</span> <span class="n">FormatBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="n">conditiontxt</span><span class="o">=</span> <span class="n">FormatBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;txt&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavetxt</span><span class="o">==</span><span class="mi">1</span>
            <span class="n">conditioncsv</span><span class="o">=</span> <span class="n">FormatBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;csv&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavecsv</span><span class="o">==</span><span class="mi">1</span>
            <span class="n">conditiondat</span><span class="o">=</span> <span class="n">FormatBox</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span><span class="o">==</span><span class="s2">&quot;dat&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavedat</span><span class="o">==</span><span class="mi">1</span>   
            <span class="n">total_condition</span><span class="o">=</span> <span class="n">conditiontxt</span> <span class="ow">or</span> <span class="n">conditiondat</span> <span class="ow">or</span> <span class="n">conditioncsv</span>
            <span class="n">folder_path</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">savefile</span><span class="o">.</span><span class="n">read_default_data</span><span class="p">()[</span><span class="s1">&#39;Folder path&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">total_condition</span><span class="p">:</span>
                <span class="n">current_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="n">current_date_str</span><span class="o">=</span><span class="n">current_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="n">fitSetting</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;ExpDecay&quot;</span><span class="p">:</span>
                    <span class="n">fitSetting</span><span class="o">=</span><span class="s2">&quot;Exponential Fit:&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I_0*e^(-t/tau_0)&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Tau_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;Kohlrausch&quot;</span><span class="p">:</span>
                    <span class="n">fitSetting</span><span class="o">=</span><span class="s2">&quot;Kohlrausch Fit:&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I_0*e^((-t/tau_0)^(Beta))&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Tau_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Beta: &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;ShiftedExponential&quot;</span><span class="p">:</span>
                    <span class="n">fitSetting</span><span class="o">=</span><span class="s2">&quot;Shifted Exponential Fit&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I_0*e^((-t+alpha)/tau_0))+b&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Tau_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;alpha: &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;b: &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;DoubleExponential&quot;</span><span class="p">:</span>
                    <span class="n">fitSetting</span><span class="o">=</span><span class="s2">&quot;Double Exponential Fit&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I0*(alpha*np.exp(-t/tau0)+(1-alpha)*np.exp(-t/tau1))&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Tau_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;I_0:&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Tau_1: &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;alpha: &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">FitParameters</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentFit</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">fitSetting</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
                    
                <span class="c1">#Channel Setting</span>
                <span class="n">fitSetting</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Start Channel: &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStartChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                <span class="n">fitSetting</span><span class="o">+=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;Stop Channel: &#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">comboBoxStopChannel</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
                
                
                <span class="c1">#Put the settings and fit</span>
                <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;LifeTimeMeasurement&quot;</span><span class="o">+</span><span class="n">current_date_str</span>
                <span class="c1">#Round the values in order to get a better txt files</span>
                <span class="n">newMeasuredTime</span><span class="o">=</span><span class="p">[]</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">measuredTime</span><span class="p">:</span>
                    <span class="n">newValue</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
                    <span class="n">newMeasuredTime</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newValue</span><span class="p">)</span>
                <span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">newMeasuredTime</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">measuredData</span> <span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">savefile</span><span class="o">.</span><span class="n">save_LifeTime_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="n">folder_path</span><span class="p">,</span><span class="n">fitSetting</span><span class="p">,</span><span class="n">selected_format</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unitsLabel</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">oldtxtName</span><span class="o">=</span><span class="n">filename</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavetxt</span><span class="o">=</span><span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;csv&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">oldcsvName</span><span class="o">=</span><span class="n">filename</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavecsv</span><span class="o">=</span><span class="mi">1</span>
                    <span class="k">elif</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;dat&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">olddatName</span><span class="o">=</span><span class="n">filename</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">sentinelsavedat</span><span class="o">=</span><span class="mi">1</span>
                    <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span>
                        <span class="n">textRoute</span><span class="o">=</span><span class="s2">&quot;The files have been saved in path folder: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">folder_path</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;with the name: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oldtxtName</span><span class="o">+</span><span class="s2">&quot;.txt&quot;</span>
                    <span class="k">elif</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;csv&quot;</span><span class="p">:</span>
                        <span class="n">textRoute</span><span class="o">=</span><span class="s2">&quot;The files have been saved in path folder: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">folder_path</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;with the name: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oldcsvName</span><span class="o">+</span><span class="s2">&quot;.csv&quot;</span>
                    <span class="k">elif</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;dat&quot;</span><span class="p">:</span>
                        <span class="n">textRoute</span><span class="o">=</span><span class="s2">&quot;The files have been saved in path folder: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">folder_path</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;with the name: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">olddatName</span><span class="o">+</span><span class="s2">&quot;.dat&quot;</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">textRoute</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Successful save&quot;</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>   
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;The changes could not be saved.&quot;</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Error saving&quot;</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                    <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>         
            <span class="k">else</span><span class="p">:</span>
                <span class="n">message_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Information</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;txt&quot;</span><span class="p">:</span>
                    <span class="n">textRoute</span><span class="o">=</span><span class="s2">&quot;The files have already been saved in path folder: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">folder_path</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;with the name: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oldtxtName</span><span class="o">+</span><span class="s2">&quot;.txt&quot;</span>
                <span class="k">elif</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;csv&quot;</span><span class="p">:</span>
                    <span class="n">textRoute</span><span class="o">=</span><span class="s2">&quot;The files have already been saved in path folder: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">folder_path</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;with the name: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oldcsvName</span><span class="o">+</span><span class="s2">&quot;.csv&quot;</span>
                <span class="k">elif</span> <span class="n">selected_format</span><span class="o">==</span><span class="s2">&quot;dat&quot;</span><span class="p">:</span>
                    <span class="n">textRoute</span><span class="o">=</span><span class="s2">&quot;The files have already been saved in path folder: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">folder_path</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="s2">&quot;with the name: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">olddatName</span><span class="o">+</span><span class="s2">&quot;.dat&quot;</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">textRoute</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Successful save&quot;</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
                <span class="n">message_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="LifeTimeGraphic.lostConnection"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.LifeTimeGraphic.lostConnection">[docs]</a>    <span class="k">def</span> <span class="nf">lostConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">msg_box</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">)</span>
        <span class="n">msg_box</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Connection with the device has been lost&quot;</span><span class="p">)</span>
        <span class="n">msg_box</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Connection Error&quot;</span><span class="p">)</span>
        <span class="n">msg_box</span><span class="o">.</span><span class="n">setIcon</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Critical</span><span class="p">)</span>
        <span class="n">msg_box</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Ok</span><span class="p">)</span>
        <span class="n">msg_box</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div></div>
    
    



<span class="c1">#The measurement is created in a thread in order to avoid a low performance in the graphic interface</span>
<span class="c1">#AVOID TO CHANGE SOMETING OF THE GRAPHIC INTERFACE IN THE THREAD</span>
<span class="c1">#THREAD IS ONLY TO MANAGE, MEASURE AND CALCULATE DATA</span>
<span class="c1">#AVOID TO CLOSE THE THREAD WITH PYQT5 METHODS LIKE .CLOSE(), .EXIT(), .QUIT(), .STOP() </span>
<span class="c1">#TO CLOSE THE THREAD LET RUN THE MAIN FUNCTION UNTIL FINAL</span>
<div class="viewcode-block" id="WorkerThreadLifeTime"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime">[docs]</a><span class="k">class</span> <span class="nc">WorkerThreadLifeTime</span><span class="p">(</span><span class="n">QThread</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Worker thread for handling LifeTime (Fluorescence Lifetime Measurement) processing in a separate thread </span>
<span class="sd">    to ensure that the GUI remains responsive during measurements.</span>

<span class="sd">    This class performs the measurement tasks in the background, processes the data, and communicates with </span>
<span class="sd">    the main thread to update the GUI with the measurement status, results, and other relevant information.</span>
<span class="sd">    </span>
<span class="sd">    Signals:</span>
<span class="sd">        - createdSignal: Signal emitted when the worker thread is created.</span>
<span class="sd">        - statusSignal: Signal emitted to update the status message in the GUI.</span>
<span class="sd">        - pointSignal: Signal emitted to update the current measurement point.</span>
<span class="sd">        - updateValues: Signal emitted to update measurement values and corresponding times.</span>
<span class="sd">        - updateLabel: Signal emitted to update a specific label in the GUI.</span>
<span class="sd">        - updateMeasurementsLabel: Signal emitted to update the label showing the number of measurements taken.</span>

<span class="sd">    :param deviceStartChannel: The start channel of the Tempico device used for measurement (TempicoChannel).</span>
<span class="sd">    :param deviceStopChannel: The stop channel of the Tempico device used for measurement (TempicoChannel).</span>
<span class="sd">    :param binwidthText: The selected bin width for the measurement (str).</span>
<span class="sd">    :param numberMeasurements: The number of measurements to be taken (int).</span>
<span class="sd">    :param device: The Tempico device used for performing measurements (Tempico).</span>
<span class="sd">    :param TimeRange: The time range for the measurements (int).</span>
<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">createdSignal</span><span class="o">=</span><span class="n">Signal</span><span class="p">()</span>
    <span class="n">statusSignal</span><span class="o">=</span><span class="n">Signal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">pointSignal</span><span class="o">=</span><span class="n">Signal</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">updateValues</span><span class="o">=</span><span class="n">Signal</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">updateLabel</span><span class="o">=</span><span class="n">Signal</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">updateMeasurementsLabel</span><span class="o">=</span><span class="n">Signal</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span>
    <span class="n">disconectedSignal</span><span class="o">=</span><span class="n">Signal</span><span class="p">()</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">deviceStartChannel</span><span class="p">,</span><span class="n">deviceStopChannel</span><span class="p">,</span><span class="n">binwidthText</span><span class="p">,</span><span class="n">numberMeasurements</span><span class="p">,</span><span class="n">device</span><span class="p">,</span><span class="n">TimeRange</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1">#Parameters of the measurement</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalTime</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalStarts</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalRuns</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1">#Class parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_running</span><span class="o">=</span><span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deviceStartChannel</span><span class="o">=</span><span class="n">deviceStartChannel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deviceStopChannel</span><span class="o">=</span><span class="n">deviceStopChannel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binwidthText</span><span class="o">=</span><span class="n">binwidthText</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurements</span><span class="o">=</span><span class="n">numberMeasurements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span><span class="o">=</span><span class="n">TimeRange</span>
        <span class="c1">#Getting the value in picoSeconds of binWidtrh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getBinWidthNumber</span><span class="p">()</span>
        <span class="c1">#Getting the mode of the device</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measurementMode</span><span class="p">()</span>
        <span class="c1">#Measurement List</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1">#Get the sequence of no measurements</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">=</span><span class="mi">0</span>
        
    <span class="c1">#Main Function</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.run"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs the measurement thread, continuously taking measurements based on user-selected values</span>
<span class="sd">        and passing them to the graphs.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">createdSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurements</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_running</span><span class="p">:</span>
            
            <span class="n">percentage</span><span class="o">=</span><span class="nb">round</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurements</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">checkDeviceStatus</span><span class="p">()</span>
            <span class="c1">#Try in order to avoid the errors related to suddenly disconnect the device</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">takeMeasurements</span><span class="p">(</span><span class="n">percentage</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">createLifeTimeData</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span></div>
            
    <span class="c1">#Functon to define the mode of the measurement</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.measurementMode"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.measurementMode">[docs]</a>    <span class="k">def</span> <span class="nf">measurementMode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the measurement mode for the device channels based on the specified time range.</span>

<span class="sd">        If the time range is less than or equal to 500000 ps , sets all channels to mode 1.</span>
<span class="sd">        Otherwise, sets all channels to mode 2.</span>

<span class="sd">        :param self: The instance of the class.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span><span class="o">&lt;=</span><span class="mi">500000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch1</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch2</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch3</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">ch4</span><span class="o">.</span><span class="n">setMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></div>
        
    <span class="c1">#Take one measurement function</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.takeMeasurements"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.takeMeasurements">[docs]</a>    <span class="k">def</span> <span class="nf">takeMeasurements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">percentage</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes measurements from the device and updates the start-stop differences list.</span>

<span class="sd">        Configures the device for measurement runs and checks the input and stop channels for data.</span>
<span class="sd">        If no measurements are detected, emits a status signal to update the main thread about the current measurement state.</span>

<span class="sd">        :param percentage: The percentage of measurement completion (float).</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Init the config to take measurement</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">setNumberOfRuns</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviceStartChannel</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deviceStartChannel</span><span class="o">.</span><span class="n">setStopMask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deviceStartChannel</span><span class="o">.</span><span class="n">setNumberOfStops</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deviceStopChannel</span><span class="o">.</span><span class="n">setStopMask</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deviceStopChannel</span><span class="o">.</span><span class="n">setNumberOfStops</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">measurement</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">measure</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">totalRuns</span><span class="o">+=</span><span class="mi">100</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">+=</span><span class="mi">100</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statusSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;Measurement running: Input Channel is not taking measurements&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pointSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">&gt;=</span><span class="mi">100</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">statusSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;Measurement running: Stop Channel is not taking measurements&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pointSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">statusSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;Measurement running: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">percentage</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_running</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="c1">#TO DO: CHANGE THE VALUE ACCORDING TO THE CHANNEL</span>
                    <span class="c1">#TO DO: CHECK IF THE START VALUE IS THE SAME</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deviceStartChannel</span><span class="o">!=</span><span class="kc">None</span><span class="p">:</span>
                        <span class="n">currentStartMeasurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">currentStopMeasurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">100</span><span class="p">]</span>
                        <span class="n">sentinelStart</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">currentStartMeasurement</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">currentStartMeasurement</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span>
                        <span class="n">sentinelStop</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">currentStopMeasurement</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">currentStopMeasurement</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span>
                        <span class="k">if</span> <span class="n">sentinelStart</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">totalStarts</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="k">if</span> <span class="n">sentinelStart</span> <span class="ow">and</span> <span class="n">sentinelStop</span><span class="p">:</span>
                            <span class="n">differenceValue</span><span class="o">=</span><span class="n">currentStopMeasurement</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">currentStartMeasurement</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">+=</span><span class="mi">1</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">totalTime</span><span class="o">+=</span><span class="n">differenceValue</span>
                            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">differenceValue</span><span class="p">)</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">=</span><span class="mi">0</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">differenceValue</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">+=</span><span class="mi">1</span>
                            
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">+=</span><span class="mi">1</span>
                        
                                
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">currentStopMeasurement</span><span class="o">=</span><span class="n">measurement</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="n">sentinelStop</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">currentStopMeasurement</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">currentStopMeasurement</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">!=-</span><span class="mi">1</span>
                        <span class="n">partialStop</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">currentStopMeasurement</span><span class="p">)</span><span class="o">==</span><span class="mi">4</span> 
                        <span class="k">if</span> <span class="n">sentinelStop</span><span class="p">:</span>
                            <span class="n">differenceValue</span><span class="o">=</span><span class="n">currentStopMeasurement</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">differenceValue</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">+=</span><span class="mi">1</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">totalTime</span><span class="o">+=</span><span class="n">differenceValue</span>
                                <span class="k">if</span> <span class="n">differenceValue</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span><span class="p">:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">=</span><span class="mi">0</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">differenceValue</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">+=</span><span class="mi">1</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">+=</span><span class="mi">1</span>
                        <span class="k">if</span> <span class="n">partialStop</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">totalStarts</span><span class="o">+=</span><span class="mi">1</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">numberMeasurements</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">&gt;=</span><span class="mi">100</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">statusSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;Measurement running: Stop Channel is not taking measurements&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pointSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                    
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">totalRuns</span><span class="o">+=</span><span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">noMeasurementsCounter</span><span class="o">+=</span><span class="mi">100</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">statusSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;Measurement running: Input Channel is not taking measurements&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pointSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span></div>
                
                
    <span class="c1">#Function to created the data to update the histogram graphic</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.createLifeTimeData"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.createLifeTimeData">[docs]</a>    <span class="k">def</span> <span class="nf">createLifeTimeData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates LifeTime data from the start-stop differences and emits the calculated results to the main thread.</span>

<span class="sd">        Processes the collected data to determine the number of counts within a given time based on the maximum value of start-stop differences.</span>
<span class="sd">        Normalizes the data according to the determined units and calculates the histogram counts.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">maximumValue</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="p">)</span>
            <span class="n">minimunValue</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">maximumValue</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">abs</span><span class="p">(</span><span class="n">minimunValue</span><span class="p">)</span> <span class="ow">and</span> <span class="n">minimunValue</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">maximumValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span>
                <span class="n">minimunValue</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span>
            <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">maximumValue</span><span class="p">)</span><span class="o">&lt;=</span><span class="nb">abs</span><span class="p">(</span><span class="n">minimunValue</span><span class="p">)</span> <span class="ow">and</span> <span class="n">minimunValue</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">maximumValue</span><span class="o">=-</span><span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span>
                <span class="n">minimunValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span>
            <span class="k">elif</span> <span class="n">minimunValue</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">maximumValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TimeRange</span>
                <span class="n">minimunValue</span><span class="o">=</span><span class="mi">0</span>
            
            <span class="n">unitsDivisionFactor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getUnits</span><span class="p">(</span><span class="n">maximumValue</span><span class="p">)</span>
            <span class="n">units</span><span class="o">=</span><span class="n">unitsDivisionFactor</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">divisionFactor</span><span class="o">=</span><span class="n">unitsDivisionFactor</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">newDifferences</span><span class="o">=</span><span class="p">[]</span>
            <span class="c1">#Normalizing the data according to the units</span>
            <span class="k">if</span> <span class="n">divisionFactor</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">newDifferences</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span>
                <span class="n">newBinWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">binwidthPicoSeconds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newBinWidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">binwidthPicoSeconds</span><span class="o">/</span><span class="n">divisionFactor</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="p">)):</span>
                    <span class="n">currentValue</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">newValue</span><span class="o">=</span><span class="n">currentValue</span><span class="o">/</span><span class="n">divisionFactor</span>
                    <span class="n">newDifferences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newValue</span><span class="p">)</span>
            <span class="n">domainValues</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="n">minimunValue</span><span class="o">/</span><span class="n">divisionFactor</span><span class="p">,</span><span class="n">maximumValue</span><span class="o">/</span><span class="n">divisionFactor</span><span class="o">+</span><span class="n">newBinWidth</span><span class="p">,</span><span class="n">newBinWidth</span><span class="p">)</span>
            <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">appnd</span><span class="p">(</span><span class="n">domainValues</span> <span class="o">-</span> <span class="n">newBinWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">domainValues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">newBinWidth</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">counts</span><span class="p">,</span><span class="n">_</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span><span class="n">newDifferences</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bin_edges</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateValues</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span><span class="n">domainValues</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateLabel</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">units</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateMeasurementsLabel</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="p">),</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">totalStarts</span><span class="p">))</span></div>
            
    <span class="c1">#Function to get the scale in time of the histogram</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.getUnits"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.getUnits">[docs]</a>    <span class="k">def</span> <span class="nf">getUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">picosecondsValue</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determines the appropriate units for a given value in picoseconds.</span>

<span class="sd">        Converts a given value in picoseconds to the most suitable time unit (picoseconds, nanoseconds, microseconds, or milliseconds).</span>

<span class="sd">        :param picosecondsValue: The value in picoseconds (float).</span>
<span class="sd">        :return: A list containing the unit as a string and the factor by which to divide the value (list).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">picosecondsValue</span> <span class="o">&lt;</span> <span class="mf">1e3</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;ps&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">picosecondsValue</span> <span class="o">&lt;</span> <span class="mf">1e6</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;ns&quot;</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">picosecondsValue</span> <span class="o">&lt;</span> <span class="mf">1e9</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;µs&quot;</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">picosecondsValue</span> <span class="o">&lt;</span> <span class="mf">1e12</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">]</span></div>
        
<div class="viewcode-block" id="WorkerThreadLifeTime.getBinWidthNumber"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.getBinWidthNumber">[docs]</a>    <span class="k">def</span> <span class="nf">getBinWidthNumber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the bin width in picoseconds based on user input in different units.</span>

<span class="sd">        Extracts the numerical value and its corresponding unit from the user-provided text,</span>
<span class="sd">        and converts it into picoseconds for further calculations.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">splitList</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">binwidthText</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="n">number</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">splitList</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">units</span><span class="o">=</span><span class="n">splitList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">units</span><span class="o">==</span><span class="s1">&#39;ps&#39;</span><span class="p">:</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span>
        <span class="k">elif</span> <span class="n">units</span><span class="o">==</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
        <span class="k">elif</span> <span class="n">units</span><span class="o">==</span><span class="s1">&#39;µs&#39;</span><span class="p">:</span>
            <span class="n">multiplier</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binwidthPicoSeconds</span><span class="o">=</span><span class="n">number</span><span class="o">*</span><span class="n">multiplier</span></div>
    
    <span class="c1">#Function to clear the graphic</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.clear"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clears the recorded start-stop differences and resets the total measurement count.</span>

<span class="sd">        This function empties the list that stores the differences between start and stop measurements,</span>
<span class="sd">        and sets the total number of measurements back to zero.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startStopDifferences</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalMeasurements</span><span class="o">=</span><span class="mi">0</span></div>
    
    <span class="c1">#Check the connection of the device</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.checkDeviceStatus"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.checkDeviceStatus">[docs]</a>    <span class="k">def</span> <span class="nf">checkDeviceStatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the status of the device by attempting to read a parameter.</span>

<span class="sd">        If an error occurs during the read operation, the measurement process is stopped.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">device</span><span class="o">.</span><span class="n">readIdnFromDevice</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span></div>
    
    <span class="c1">#Stop thread function</span>
<div class="viewcode-block" id="WorkerThreadLifeTime.stop"><a class="viewcode-back" href="../LifeTimeGraphics.html#LifeTimeGraphics.WorkerThreadLifeTime.stop">[docs]</a>    <span class="nd">@Slot</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stops the measurement process by setting the running flag to False.</span>

<span class="sd">        Emits a status message indicating that the measurement is ending and updates the status bar color to yellow.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_running</span><span class="o">=</span><span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s2">&quot;Ending measurement&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pointSignal</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></div></div>
    
    
        
        
    
    
    
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025,Tausand Electronics.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>